{"title":"Análisis estatuto de Urrao","markdown":{"yaml":{"title":"Análisis estatuto de Urrao","format":{"html":{"toc":true,"toc-depth":3,"number-sections":true,"theme":"cosmo","smooth-scroll":true}},"execute":{"echo":false,"warning":false,"message":false},"params":{"cod_dane":"05847","nombre":"Urrao"},"lang":"es"},"headingText":"Función para leer archivos RDS con rutas relativas","containsRefs":false,"markdown":"\n\n\nEste proyecto presenta un análisis exhaustivo de los estatutos tributarios del municipio de \nPara el análisis del municipio de , enfocándose específicamente en la estructura del impuesto predial. El estatuto fue acompañado de un análisis jurídico y de contenido detallado del capítulo de impuestos prediales contenido en sus estatutos de rentas.\n\nPara el análisis del municipio se tuvieron  en cuenta los siguientes estatutos y modificaciones:\n\n```{r}\n#| echo: false\n#| message: false\n#| warning: false\n\nlee_rds <- function(rel){\n  candidatos <- c(rel, file.path('..', rel), file.path('..','..', rel))\n  existente <- candidatos[file.exists(candidatos)][1]\n  if(is.na(existente)) stop('No se encontró ', rel, ' en rutas: ', paste(candidatos, collapse=', '))\n  readRDS(existente)\n}\n\n# Cargar librerías necesarias\nlibrary(dplyr)\nlibrary(knitr)\nlibrary(ggplot2)\nlibrary(scales)\nsuppressPackageStartupMessages({\n  library(gridExtra, quietly = TRUE)\n  library(grid, quietly = TRUE)\n  library(tidyr, quietly = TRUE)\n})\n\n# Configurar opciones de gráficos\noptions(scipen = 999)  # Evitar notación científica\n\n# Cargar datos completos con manejo de ausencia del archivo\ndatos_disponibles <- TRUE\nbd_estatutos <- NULL\ntryCatch({\n  bd_estatutos <- lee_rds(\"ds_estatutos/BD_Estatutos.rds\")\n}, error = function(e){\n  datos_disponibles <<- FALSE\n  mensaje <- paste0(\"⚠️ No se encontró el dataset 'BD_Estatutos.rds'. Se mostrará una versión reducida del informe. Detalle: \", e$message)\n  message(mensaje)\n  cat(mensaje, \"\\n\\n\")\n})\n\n# Filtrar para el municipio específico (si hay datos)\nif (datos_disponibles) {\n  datos_municipio <- bd_estatutos %>% filter(codigo_dane == params$cod_dane)\n} else {\n  datos_municipio <- data.frame()\n}\n\n# Tabla de estatutos\nfreq_cat <- datos_municipio %>%\n  mutate(\n    filename = if ('filename' %in% names(cur_data_all())) filename else NA_character_,\n    enlace_pdf = if_else(!is.na(filename) & filename != \"\", \n                         paste0(\"[Descargar PDF](pdfs/\", filename, \")\"), \n                         \"No disponible\")\n  ) %>%\n  select(any_of(c(\"mpio\",\"anio\",\"tipo\",\"numero\",\"observaciones\",\"enlace_pdf\")))\n\nif (nrow(freq_cat) == 0) {\n  cat(\"No hay estatutos registrados para este municipio.\\n\")\n} else {\n  knitr::kable(head(freq_cat, 200), caption = \"Estatutos Usados para el Estudio\", escape = FALSE)\n}\n```\n\n\nPara ver más análisis agregados y los detalles metodológicos puede visitar este enlace [(ir)](https://jcmunozmora.github.io/estatutos_analisis/).\n\n# Estadísticas del municipio\n\n```{r}\n#| echo: false\n#| message: false\n#| warning: false\n\nif (nrow(datos_municipio) > 0) {\n  # Estadísticas básicas\n  cat(\"## Resumen estadístico\\n\\n\")\n  cat(\"- **Total de registros analizados:** \", nrow(datos_municipio), \"\\n\")\n  \n  if (\"anio\" %in% names(datos_municipio)) {\n    anos_unicos <- sort(unique(datos_municipio$anio[!is.na(datos_municipio$anio)]))\n    if (length(anos_unicos) > 0) {\n      cat(\"- **Período analizado:** \", min(anos_unicos), \" - \", max(anos_unicos), \"\\n\")\n      cat(\"- **Años con estatutos:** \", paste(anos_unicos, collapse = \", \"), \"\\n\")\n    }\n  }\n  \n  if (\"tipo\" %in% names(datos_municipio)) {\n    tipos_unicos <- unique(datos_municipio$tipo[!is.na(datos_municipio$tipo)])\n    if (length(tipos_unicos) > 0) {\n      cat(\"- **Tipos de normativa:** \", paste(tipos_unicos, collapse = \", \"), \"\\n\")\n    }\n  }\n  \n  # Comparación con el departamento\n  total_departamento <- nrow(bd_estatutos)\n  porcentaje <- round((nrow(datos_municipio) / total_departamento) * 100, 2)\n  cat(\"- **Representación en el estudio:** \", porcentaje, \"% del total departamental\\n\")\n  \n} else {\n  cat(\"No hay datos disponibles para generar estadísticas.\\n\")\n}\n```\n\n# Análisis de estructura tarifaria\n\n## Combinaciones de criterios tarifarios\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 10\n#| fig-height: 6\n\n# Verificar si existe la imagen de combinaciones para este municipio\nimg_combos <- paste0(\"img_estatutos/\", params$cod_dane, \"_combos.png\")\n\nif (file.exists(img_combos)) {\n  cat(\"Este gráfico muestra las diferentes combinaciones de criterios utilizados en la estructura tarifaria del municipio:\\n\\n\")\n  cat(\"![Combinaciones de criterios tarifarios](\", img_combos, \"){width=90%}\\n\\n\")\n  cat(\"**Descripción:** Visualización de las combinaciones de criterios (avalúo, área, destino, estrato, etc.) utilizadas para determinar las tarifas prediales en \", params$nombre, \".\\n\\n\")\n  cat(\"**Interpretación:** Cada combinación representa una regla específica del estatuto tributario. Mayor número de combinaciones indica mayor complejidad normativa.\\n\\n\")\n} else {\n  # Generar análisis dinámico desde los datos\n  cat(\"### Análisis de criterios tarifarios (generado dinámicamente)\\n\\n\")\n  \n  tryCatch({\n    bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n    \n    # Filtrar datos del municipio\n    datos_criterios <- bd_transcripciones %>%\n      filter(codigo_dane == params$cod_dane)\n    \n    if (nrow(datos_criterios) > 0) {\n      library(ggplot2)\n      library(dplyr)\n      \n      # Analizar qué criterios se utilizan\n      criterios_utilizados <- datos_criterios %>%\n        summarise(\n          usa_avaluo = any(!is.na(avaluo_desde) | !is.na(avaluo_hasta)),\n          usa_area = any(!is.na(area_desde) | !is.na(area_hasta)),\n          usa_destino = any(!is.na(destino) & destino != \"\"),\n          usa_estrato = any(!is.na(estrato) & estrato != \"\"),\n          usa_zona = any(!is.na(zona) & zona != \"\")\n        )\n      \n      # Crear resumen de criterios\n      criterios_activos <- c()\n      if (criterios_utilizados$usa_avaluo) criterios_activos <- c(criterios_activos, \"Avalúo\")\n      if (criterios_utilizados$usa_area) criterios_activos <- c(criterios_activos, \"Área\")\n      if (criterios_utilizados$usa_destino) criterios_activos <- c(criterios_activos, \"Destino\")\n      if (criterios_utilizados$usa_estrato) criterios_activos <- c(criterios_activos, \"Estrato\")\n      if (criterios_utilizados$usa_zona) criterios_activos <- c(criterios_activos, \"Zona\")\n      \n      cat(\"**Criterios tarifarios identificados:**\\n\")\n      if (length(criterios_activos) > 0) {\n        for (criterio in criterios_activos) {\n          cat(\"- ✓ \", criterio, \"\\n\")\n        }\n      } else {\n        cat(\"- No se identificaron criterios específicos en los datos disponibles\\n\")\n      }\n      cat(\"\\n\")\n      \n      # Análisis de combinaciones más frecuentes\n      if (length(criterios_activos) > 1) {\n        # Crear combinaciones de criterios\n        combinaciones <- datos_criterios %>%\n          mutate(\n            combinacion = paste(\n              ifelse(!is.na(avaluo_desde) | !is.na(avaluo_hasta), \"Avalúo\", \"\"),\n              ifelse(!is.na(area_desde) | !is.na(area_hasta), \"Área\", \"\"),\n              ifelse(!is.na(destino) & destino != \"\", \"Destino\", \"\"),\n              ifelse(!is.na(estrato) & estrato != \"\", \"Estrato\", \"\"),\n              ifelse(!is.na(zona) & zona != \"\", \"Zona\", \"\"),\n              sep = \"+\"\n            )\n          ) %>%\n          mutate(combinacion = gsub(\"\\\\+{2,}\", \"+\", combinacion)) %>%\n          mutate(combinacion = gsub(\"^\\\\+|\\\\+$\", \"\", combinacion)) %>%\n          filter(combinacion != \"\") %>%\n          count(combinacion, sort = TRUE)\n        \n        if (nrow(combinaciones) > 0) {\n          cat(\"**Combinaciones de criterios más frecuentes:**\\n\")\n          for (i in 1:min(5, nrow(combinaciones))) {\n            cat(\"- \", combinaciones$combinacion[i], \": \", combinaciones$n[i], \" reglas\\n\")\n          }\n          cat(\"\\n\")\n          \n          # Gráfico de barras de combinaciones\n          if (nrow(combinaciones) > 1) {\n            p_combos <- ggplot(head(combinaciones, 10), aes(x = reorder(combinacion, n), y = n)) +\n              geom_col(fill = \"steelblue\", alpha = 0.8) +\n              coord_flip() +\n              labs(\n                title = paste(\"Combinaciones de criterios tarifarios -\", params$nombre),\n                subtitle = \"Top 10 combinaciones más utilizadas\",\n                x = \"Combinación de criterios\",\n                y = \"Número de reglas\",\n                caption = \"Fuente: Análisis de estatutos tributarios\"\n              ) +\n              theme_minimal() +\n              theme(\n                plot.title = element_text(size = 14, face = \"bold\"),\n                plot.subtitle = element_text(size = 12),\n                axis.title = element_text(size = 11)\n              )\n            \n            print(p_combos)\n          }\n        }\n      }\n      \n      # Estadísticas de complejidad\n      cat(\"\\n**Análisis de complejidad normativa:**\\n\")\n      cat(\"- **Total de reglas analizadas:** \", nrow(datos_criterios), \"\\n\")\n      cat(\"- **Número de criterios utilizados:** \", length(criterios_activos), \"\\n\")\n      \n      if (length(criterios_activos) >= 3) {\n        cat(\"- **Clasificación:** Sistema de alta complejidad (múltiples criterios)\\n\")\n      } else if (length(criterios_activos) == 2) {\n        cat(\"- **Clasificación:** Sistema de complejidad moderada\\n\")\n      } else {\n        cat(\"- **Clasificación:** Sistema de baja complejidad (criterio único o simple)\\n\")\n      }\n      \n    } else {\n      cat(\"No se encontraron datos de criterios tarifarios para este municipio.\\n\")\n    }\n    \n  }, error = function(e) {\n    cat(\"*No fue posible generar el análisis de criterios tarifarios para este municipio.*\\n\")\n    cat(\"*Motivo: Datos de transcripción no disponibles o incompletos.*\\n\")\n  })\n}\n```\n\n## Distribución de tarifas\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 10\n#| fig-height: 6\n\n# Verificar si existe la imagen de distribución de tarifas\nimg_tarifas <- paste0(\"img_estatutos/\", params$cod_dane, \"_dist_tarifas.png\")\n\nif (file.exists(img_tarifas)) {\n  cat(\"La distribución de tarifas muestra el rango y frecuencia de las diferentes tarifas prediales establecidas:\\n\\n\")\n  cat(\"![Distribución de tarifas prediales](\", img_tarifas, \"){width=90%}\\n\\n\")\n  cat(\"**Descripción:** Histograma que muestra la distribución de las tarifas prediales por mil (‰) establecidas en el estatuto de \", params$nombre, \".\\n\\n\")\n  cat(\"**Interpretación:** La forma de la distribución indica si el municipio tiende hacia tarifas uniformes (distribución concentrada) o hacia un esquema más diversificado (distribución dispersa).\\n\\n\")\n} else {\n  # Generar gráfico dinámico desde los datos\n  cat(\"### Distribución de tarifas prediales (generado dinámicamente)\\n\\n\")\n  \n  tryCatch({\n    bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n    \n    # Filtrar datos del municipio\n    datos_tarifas <- bd_transcripciones %>%\n      filter(codigo_dane == params$cod_dane) %>%\n      filter(!is.na(tarifa), tarifa > 0)\n    \n    if (nrow(datos_tarifas) > 0) {\n      library(ggplot2)\n      \n      # Crear histograma de distribución de tarifas mejorado\n      p_dist <- ggplot(datos_tarifas, aes(x = tarifa)) +\n        geom_histogram(aes(y = after_stat(density)), \n                       bins = min(30, max(5, nrow(datos_tarifas)/3)), \n                       fill = \"lightblue\", color = \"darkblue\", alpha = 0.7, size = 0.3) +\n        geom_density(alpha = 0.3, fill = \"blue\", color = \"blue\", size = 1) +\n        geom_vline(aes(xintercept = median(tarifa)), \n                   color = \"red\", linetype = \"dashed\", size = 1.2) +\n        geom_vline(aes(xintercept = mean(tarifa)), \n                   color = \"orange\", linetype = \"dashed\", size = 1.2) +\n        geom_vline(aes(xintercept = quantile(tarifa, 0.25)), \n                   color = \"purple\", linetype = \"dotted\", size = 0.8, alpha = 0.7) +\n        geom_vline(aes(xintercept = quantile(tarifa, 0.75)), \n                   color = \"purple\", linetype = \"dotted\", size = 0.8, alpha = 0.7) +\n        scale_x_continuous(\n          labels = scales::number_format(suffix = \"‰\"),\n          name = \"Tarifa predial (por mil)\"\n        ) +\n        scale_y_continuous(\n          name = \"Densidad de probabilidad\",\n          labels = scales::number_format(accuracy = 0.01)\n        ) +\n        labs(\n          title = paste(\"Distribución de tarifas prediales -\", params$nombre),\n          subtitle = \"🔴 Mediana | 🟠 Promedio | 🟣 Cuartiles (P25, P75) | 🔵 Curva de densidad\",\n          caption = \"Análisis de concentración y dispersión tarifaria\"\n        ) +\n        theme_minimal() +\n        theme(\n          plot.title = element_text(size = 14, face = \"bold\", color = \"darkblue\"),\n          plot.subtitle = element_text(size = 10, color = \"gray40\"),\n          plot.caption = element_text(size = 9, color = \"gray50\"),\n          axis.title = element_text(size = 11),\n          panel.grid.minor = element_blank(),\n          panel.grid.major = element_line(color = \"gray90\", size = 0.5)\n        )\n      \n      print(p_dist)\n      \n      # Estadísticas descriptivas mejoradas\n      tarifas_unicas <- unique(datos_tarifas$tarifa)\n      rango_tarifas <- max(datos_tarifas$tarifa) - min(datos_tarifas$tarifa)\n      q10 <- quantile(datos_tarifas$tarifa, 0.1)\n      q90 <- quantile(datos_tarifas$tarifa, 0.9)\n      asimetria <- round((mean(datos_tarifas$tarifa) - median(datos_tarifas$tarifa)) / sd(datos_tarifas$tarifa), 3)\n      \n      cat(\"\\n**Estadísticas descriptivas detalladas:**\\n\")\n      cat(\"- **Número total de tarifas diferentes:** \", length(tarifas_unicas), \"\\n\")\n      cat(\"- **Rango de tarifas:** \", min(datos_tarifas$tarifa), \"‰ - \", max(datos_tarifas$tarifa), \"‰ (amplitud: \", round(rango_tarifas, 2), \"‰)\\n\")\n      cat(\"- **Medidas de tendencia central:**\\n\")\n      cat(\"  - Promedio: \", round(mean(datos_tarifas$tarifa), 2), \"‰\\n\")\n      cat(\"  - Mediana: \", round(median(datos_tarifas$tarifa), 2), \"‰\\n\")\n      cat(\"  - Moda: \", round(as.numeric(names(sort(table(datos_tarifas$tarifa), decreasing = TRUE))[1]), 2), \"‰\\n\")\n      cat(\"- **Medidas de dispersión:**\\n\")\n      cat(\"  - Desviación estándar: \", round(sd(datos_tarifas$tarifa), 2), \"‰\\n\")\n      cat(\"  - Coeficiente de variación: \", round(sd(datos_tarifas$tarifa)/mean(datos_tarifas$tarifa), 3), \"\\n\")\n      cat(\"  - Rango intercuartílico (P25-P75): \", round(quantile(datos_tarifas$tarifa, 0.75) - quantile(datos_tarifas$tarifa, 0.25), 2), \"‰\\n\")\n      cat(\"- **Percentiles clave:**\\n\")\n      cat(\"  - P10: \", round(q10, 2), \"‰ | P90: \", round(q90, 2), \"‰\\n\")\n      cat(\"- **Forma de la distribución:**\\n\")\n      cat(\"  - Asimetría: \", asimetria, if(asimetria > 0.5) \" (sesgada hacia la derecha)\" else if(asimetria < -0.5) \" (sesgada hacia la izquierda)\" else \" (aproximadamente simétrica)\", \"\\n\")\n      \n      # Análisis de dispersión con interpretación contextual\n      cv <- sd(datos_tarifas$tarifa)/mean(datos_tarifas$tarifa)\n      \n      cat(\"\\n**📊 Análisis de concentración tarifaria:**\\n\")\n      if (cv < 0.15) {\n        cat(\"- **Tipo de sistema:** UNIFORME - Las tarifas están muy concentradas\\n\")\n        cat(\"- **Ventajas:** Simplicidad administrativa, fácil comprensión ciudadana\\n\")\n        cat(\"- **Consideraciones:** Evaluar si captura diferencias en capacidad contributiva\\n\")\n      } else if (cv < 0.30) {\n        cat(\"- **Tipo de sistema:** MODERADAMENTE UNIFORME - Concentración con cierta variabilidad\\n\")\n        cat(\"- **Ventajas:** Balance entre simplicidad y diferenciación\\n\")\n        cat(\"- **Consideraciones:** Sistema equilibrado para contextos urbanos/rurales mixtos\\n\")\n      } else if (cv < 0.70) {\n        cat(\"- **Tipo de sistema:** DIVERSIFICADO - Amplio rango de tarifas\\n\")\n        cat(\"- **Ventajas:** Mayor precisión en la diferenciación contributiva\\n\")\n        cat(\"- **Consideraciones:** Requiere mayor capacidad técnica para aplicación\\n\")\n      } else {\n        cat(\"- **Tipo de sistema:** ALTAMENTE DIVERSIFICADO - Muy amplio espectro tarifario\\n\")\n        cat(\"- **Ventajas:** Máxima precisión en diferenciación\\n\")\n        cat(\"- **Consideraciones:** Alta complejidad administrativa, revisar coherencia\\n\")\n      }\n      \n      # Análisis de percentiles con interpretación\n      q25 <- quantile(datos_tarifas$tarifa, 0.25)\n      q75 <- quantile(datos_tarifas$tarifa, 0.75)\n      riq <- q75 - q25\n      cat(\"- **Rango central (P25-P75):** \", round(q25, 2), \"‰ - \", round(q75, 2), \"‰ (RIQ: \", round(riq, 2), \"‰)\\n\")\n      cat(\"- **Concentración central:** \", round((riq / median(datos_tarifas$tarifa)) * 100, 1), \"% de la mediana\\n\")\n      \n      # Detección de outliers\n      limite_inferior <- q25 - 1.5 * riq\n      limite_superior <- q75 + 1.5 * riq\n      outliers <- datos_tarifas$tarifa[datos_tarifas$tarifa < limite_inferior | datos_tarifas$tarifa > limite_superior]\n      \n      if (length(outliers) > 0) {\n        cat(\"- **⚠️ Valores atípicos detectados:** \", length(outliers), \" tarifas fuera del rango normal\\n\")\n        cat(\"  - Tarifas extremas: \", paste(round(sort(outliers), 2), collapse = \"‰, \"), \"‰\\n\")\n        cat(\"  - **Recomendación:** Revisar coherencia de estas tarifas excepcionales\\n\")\n      } else {\n        cat(\"- **✅ Sin valores atípicos:** Todas las tarifas están dentro del rango esperado\\n\")\n      }\n      \n    } else {\n      cat(\"No se encontraron datos de tarifas para este municipio.\\n\")\n    }\n    \n  }, error = function(e) {\n    cat(\"*No fue posible generar la distribución de tarifas para este municipio.*\\n\")\n    cat(\"*Motivo: Datos de transcripción no disponibles o incompletos.*\\n\")\n  })\n}\n```\n\n# Análisis de progresividad\n\n## Progresividad por avalúo\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 10\n#| fig-height: 6\n\n# Verificar si existe la imagen ladder de avalúo\nimg_avaluo <- paste0(\"img_estatutos/\", params$cod_dane, \"_ladder_avaluo.png\")\n\nif (file.exists(img_avaluo)) {\n  cat(\"El análisis de progresividad por avalúo evalúa si las tarifas aumentan proporcionalmente con el valor del predio:\\n\\n\")\n  cat(\"![Progresividad por avalúo](\", img_avaluo, \"){width=90%}\\n\\n\")\n  cat(\"**Descripción:** Gráfico ladder que muestra la relación entre rangos de avalúo (en UVT) y las tarifas correspondientes en \", params$nombre, \".\\n\\n\")\n  cat(\"**Interpretación:** Una tendencia ascendente consistente indica progresividad, donde predios de mayor valor pagan tarifas proporcionalmente más altas. Escalones horizontales indican tramos con tarifa fija.\\n\\n\")\n} else {\n  # Generar gráfico dinámico desde los datos\n  cat(\"### Análisis de progresividad por avalúo (generado dinámicamente)\\n\\n\")\n  \n  # Intentar cargar datos de transcripciones para análisis detallado\n  tryCatch({\n    bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n    \n    # Filtrar datos del municipio\n    datos_avaluo <- bd_transcripciones %>%\n      filter(codigo_dane == params$cod_dane) %>%\n      filter(!is.na(avaluo_desde) | !is.na(avaluo_hasta)) %>%\n      filter(!is.na(tarifa))\n    \n    if (nrow(datos_avaluo) > 0) {\n      library(ggplot2)\n      \n      # Preparar datos para gráfico\n      datos_plot <- datos_avaluo %>%\n        mutate(\n          avaluo_medio = case_when(\n            !is.na(avaluo_desde) & !is.na(avaluo_hasta) ~ (avaluo_desde + avaluo_hasta) / 2,\n            !is.na(avaluo_desde) ~ avaluo_desde,\n            !is.na(avaluo_hasta) ~ avaluo_hasta,\n            TRUE ~ NA_real_\n          ),\n          avaluo_desde = ifelse(is.na(avaluo_desde), 0, avaluo_desde),\n          avaluo_hasta = ifelse(is.na(avaluo_hasta), avaluo_medio * 2, avaluo_hasta)\n        ) %>%\n        filter(!is.na(avaluo_medio), !is.na(tarifa)) %>%\n        arrange(avaluo_medio)\n      \n      if (nrow(datos_plot) >= 2) {\n        # Crear gráfico ladder\n        p_avaluo <- ggplot(datos_plot, aes(x = avaluo_medio, y = tarifa)) +\n          geom_step(direction = \"hv\", color = \"steelblue\", size = 1.2) +\n          geom_point(color = \"darkblue\", size = 2) +\n          scale_x_continuous(\n            trans = \"log10\",\n            labels = scales::comma_format(scale = 1e-6, suffix = \"M\"),\n            name = \"Avalúo (UVT, escala logarítmica)\"\n          ) +\n          scale_y_continuous(\n            labels = scales::number_format(suffix = \"‰\"),\n            name = \"Tarifa predial (por mil)\"\n          ) +\n          labs(\n            title = paste(\"Progresividad por avalúo -\", params$nombre),\n            subtitle = \"Relación entre rangos de avalúo y tarifas prediales\",\n            caption = \"Fuente: Análisis de estatutos tributarios\"\n          ) +\n          theme_minimal() +\n          theme(\n            plot.title = element_text(size = 14, face = \"bold\"),\n            plot.subtitle = element_text(size = 12),\n            axis.title = element_text(size = 11),\n            panel.grid.minor = element_blank()\n          )\n        \n        print(p_avaluo)\n        \n        # Análisis de progresividad\n        correlacion <- cor(datos_plot$avaluo_medio, datos_plot$tarifa, method = \"spearman\")\n        n_intervalos <- nrow(datos_plot)\n        incrementos_positivos <- sum(diff(datos_plot$tarifa[order(datos_plot$avaluo_medio)]) > 0)\n        prop_progresiva <- round(incrementos_positivos / (n_intervalos - 1) * 100, 1)\n        \n        cat(\"\\n**Análisis estadístico:**\\n\")\n        cat(\"- **Número de intervalos analizados:** \", n_intervalos, \"\\n\")\n        cat(\"- **Correlación avalúo-tarifa (Spearman):** \", round(correlacion, 3), \"\\n\")\n        cat(\"- **Proporción de incrementos progresivos:** \", prop_progresiva, \"%\\n\")\n        \n        if (correlacion > 0.7) {\n          cat(\"- **Interpretación:** Sistema altamente progresivo\\n\")\n        } else if (correlacion > 0.3) {\n          cat(\"- **Interpretación:** Sistema moderadamente progresivo\\n\")\n        } else if (correlacion > -0.3) {\n          cat(\"- **Interpretación:** Sistema con progresividad variable\\n\")\n        } else {\n          cat(\"- **Interpretación:** Sistema con tendencia regresiva\\n\")\n        }\n        \n      } else {\n        cat(\"Datos insuficientes para generar análisis de progresividad por avalúo.\\n\")\n      }\n      \n    } else {\n      cat(\"No se encontraron datos de avalúo para este municipio en los registros detallados.\\n\")\n    }\n    \n  }, error = function(e) {\n    cat(\"*No fue posible generar el análisis de progresividad por avalúo para este municipio.*\\n\")\n    cat(\"*Motivo: Datos de transcripción no disponibles o incompletos.*\\n\")\n  })\n}\n```\n\n## Progresividad por área\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 10\n#| fig-height: 6\n\n# Verificar si existe la imagen ladder de área\nimg_area <- paste0(\"img_estatutos/\", params$cod_dane, \"_ladder_area.png\")\n\nif (file.exists(img_area)) {\n  cat(\"El análisis por área evalúa la progresividad basada en la superficie construida:\\n\\n\")\n  cat(\"![Progresividad por área](\", img_area, \"){width=90%}\\n\\n\")\n  cat(\"**Descripción:** Gráfico ladder que muestra la relación entre rangos de área construida (m²) y las tarifas prediales en \", params$nombre, \".\\n\\n\")\n  cat(\"**Interpretación:** Permite evaluar si el municipio penaliza o incentiva predios de mayor tamaño. Una progresividad negativa podría indicar incentivos a la densificación.\\n\\n\")\n} else {\n  # Generar gráfico dinámico desde los datos\n  cat(\"### Análisis de progresividad por área (generado dinámicamente)\\n\\n\")\n  \n  tryCatch({\n    bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n    \n    # Filtrar datos del municipio con información de área\n    datos_area <- bd_transcripciones %>%\n      filter(codigo_dane == params$cod_dane) %>%\n      filter(!is.na(area_desde) | !is.na(area_hasta)) %>%\n      filter(!is.na(tarifa))\n    \n    if (nrow(datos_area) > 0) {\n      library(ggplot2)\n      \n      # Preparar datos para gráfico\n      datos_plot_area <- datos_area %>%\n        mutate(\n          area_media = case_when(\n            !is.na(area_desde) & !is.na(area_hasta) ~ (area_desde + area_hasta) / 2,\n            !is.na(area_desde) ~ area_desde,\n            !is.na(area_hasta) ~ area_hasta,\n            TRUE ~ NA_real_\n          ),\n          area_desde = ifelse(is.na(area_desde), 0, area_desde),\n          area_hasta = ifelse(is.na(area_hasta), area_media * 2, area_hasta)\n        ) %>%\n        filter(!is.na(area_media), !is.na(tarifa), area_media > 0) %>%\n        arrange(area_media)\n      \n      if (nrow(datos_plot_area) >= 2) {\n        # Crear gráfico ladder para área con mejoras visuales\n        p_area <- ggplot(datos_plot_area, aes(x = area_media, y = tarifa)) +\n          geom_step(direction = \"hv\", color = \"darkgreen\", size = 1.2, alpha = 0.8) +\n          geom_point(color = \"darkgreen\", size = 2.5, alpha = 0.9) +\n          geom_smooth(method = \"loess\", se = TRUE, color = \"orange\", alpha = 0.3, size = 0.8) +\n          scale_x_continuous(\n            trans = \"log10\",\n            labels = scales::comma_format(suffix = \" m²\"),\n            name = \"Área construida (m², escala logarítmica)\",\n            breaks = scales::trans_breaks(\"log10\", function(x) 10^x),\n            minor_breaks = scales::trans_breaks(\"log10\", function(x) 10^x, n = 10)\n          ) +\n          scale_y_continuous(\n            labels = scales::number_format(suffix = \"‰\"),\n            name = \"Tarifa predial (por mil)\"\n          ) +\n          labs(\n            title = paste(\"Progresividad por área construida -\", params$nombre),\n            subtitle = \"Línea verde: escalones tarifarios | Línea naranja: tendencia suavizada\",\n            caption = \"Fuente: Análisis de estatutos tributarios • Mayor área → ¿Mayor o menor tarifa?\"\n          ) +\n          theme_minimal() +\n          theme(\n            plot.title = element_text(size = 14, face = \"bold\", color = \"darkgreen\"),\n            plot.subtitle = element_text(size = 11, color = \"gray40\"),\n            plot.caption = element_text(size = 9, color = \"gray50\"),\n            axis.title = element_text(size = 11),\n            panel.grid.minor = element_blank(),\n            panel.grid.major = element_line(color = \"gray90\", size = 0.5)\n          )\n        \n        print(p_area)\n        \n        # Análisis de progresividad por área mejorado\n        correlacion_area <- cor(datos_plot_area$area_media, datos_plot_area$tarifa, method = \"spearman\")\n        n_intervalos_area <- nrow(datos_plot_area)\n        tarifa_ordenada <- datos_plot_area$tarifa[order(datos_plot_area$area_media)]\n        incrementos_positivos_area <- sum(diff(tarifa_ordenada) > 0)\n        decrementos_area <- sum(diff(tarifa_ordenada) < 0)\n        prop_progresiva_area <- round(incrementos_positivos_area / (n_intervalos_area - 1) * 100, 1)\n        \n        # Calcular elasticidad área-tarifa\n        if (length(datos_plot_area$area_media) > 2) {\n          modelo_area <- lm(log(tarifa) ~ log(area_media), data = datos_plot_area)\n          elasticidad_area <- round(coef(modelo_area)[2], 3)\n        } else {\n          elasticidad_area <- NA\n        }\n        \n        cat(\"\\n**Análisis estadístico avanzado:**\\n\")\n        cat(\"- **Número de intervalos analizados:** \", n_intervalos_area, \"\\n\")\n        cat(\"- **Correlación área-tarifa (Spearman):** \", round(correlacion_area, 3), \"\\n\")\n        cat(\"- **Proporción de incrementos progresivos:** \", prop_progresiva_area, \"%\\n\")\n        cat(\"- **Incrementos vs. decrementos:** \", incrementos_positivos_area, \" vs \", decrementos_area, \"\\n\")\n        if (!is.na(elasticidad_area)) {\n          cat(\"- **Elasticidad área-tarifa:** \", elasticidad_area, \"\\n\")\n        }\n        \n        if (correlacion_area > 0.3) {\n          cat(\"- **Interpretación:** Las tarifas tienden a aumentar con el área (penalización a predios grandes)\\n\")\n        } else if (correlacion_area < -0.3) {\n          cat(\"- **Interpretación:** Las tarifas tienden a disminuir con el área (incentivo a predios grandes)\\n\")\n        } else {\n          cat(\"- **Interpretación:** Las tarifas no presentan una relación clara con el área\\n\")\n        }\n        \n        # Comparación con avalúo (si disponible)\n        datos_avaluo_comp <- bd_transcripciones %>%\n          filter(codigo_dane == params$cod_dane) %>%\n          filter(!is.na(avaluo_desde) | !is.na(avaluo_hasta)) %>%\n          filter(!is.na(tarifa))\n        \n        if (nrow(datos_avaluo_comp) > 1) {\n          datos_avaluo_comp <- datos_avaluo_comp %>%\n            mutate(\n              avaluo_medio = case_when(\n                !is.na(avaluo_desde) & !is.na(avaluo_hasta) ~ (avaluo_desde + avaluo_hasta) / 2,\n                !is.na(avaluo_desde) ~ avaluo_desde,\n                !is.na(avaluo_hasta) ~ avaluo_hasta,\n                TRUE ~ NA_real_\n              )\n            ) %>%\n            filter(!is.na(avaluo_medio))\n          \n          if (nrow(datos_avaluo_comp) > 1) {\n            correlacion_avaluo_comp <- cor(datos_avaluo_comp$avaluo_medio, datos_avaluo_comp$tarifa, method = \"spearman\")\n            cat(\"- **Comparación:** Correlación avalúo-tarifa: \", round(correlacion_avaluo_comp, 3), \n                \" vs área-tarifa: \", round(correlacion_area, 3), \"\\n\")\n            \n            if (abs(correlacion_area) > abs(correlacion_avaluo_comp)) {\n              cat(\"- **Observación:** El área parece ser un criterio más determinante que el avalúo\\n\")\n            } else {\n              cat(\"- **Observación:** El avalúo parece ser un criterio más determinante que el área\\n\")\n            }\n          }\n        }\n        \n      } else {\n        cat(\"Datos insuficientes para generar análisis de progresividad por área.\\n\")\n      }\n      \n    } else {\n      cat(\"No se encontraron datos de área para este municipio en los registros detallados.\\n\")\n    }\n    \n  }, error = function(e) {\n    cat(\"*No fue posible generar el análisis de progresividad por área para este municipio.*\\n\")\n    cat(\"*Motivo: Datos de transcripción no disponibles o incompletos.*\\n\")\n  })\n}\n```\n\n# Contexto departamental\n\n```{r}\n#| echo: false\n#| results: asis\n\ncat(\"## Posición relativa en Antioquia\\n\\n\")\n\n# Generar estadísticas comparativas\nif (nrow(datos_municipio) > 0) {\n  # Ranking por número de reglas\n  ranking_reglas <- bd_estatutos %>%\n    count(codigo_dane, mpio, sort = TRUE) %>%\n    mutate(ranking = row_number()) %>%\n    filter(codigo_dane == params$cod_dane)\n  \n  if (nrow(ranking_reglas) > 0) {\n    total_municipios <- bd_estatutos %>% distinct(codigo_dane) %>% nrow()\n    cat(\"- **Ranking por complejidad normativa:** \", ranking_reglas$ranking, \" de \", total_municipios, \" municipios\\n\")\n    cat(\"- **Número de reglas:** \", ranking_reglas$n, \"\\n\")\n    \n    # Clasificación\n    if (ranking_reglas$ranking <= total_municipios * 0.25) {\n      cat(\"- **Clasificación:** Alta complejidad normativa (cuartil superior)\\n\")\n    } else if (ranking_reglas$ranking <= total_municipios * 0.5) {\n      cat(\"- **Clasificación:** Complejidad normativa medio-alta\\n\")\n    } else if (ranking_reglas$ranking <= total_municipios * 0.75) {\n      cat(\"- **Clasificación:** Complejidad normativa medio-baja\\n\")\n    } else {\n      cat(\"- **Clasificación:** Baja complejidad normativa (cuartil inferior)\\n\")\n    }\n  }\n}\n\ncat(\"\\n\")\n\n# Enlaces a visualizaciones generales si existen\nimg_generales <- c(\n  \"tipologia_agregada.png\" = \"Tipologías agregadas del departamento\",\n  \"tipologia_todos.png\" = \"Complejidad normativa por municipio\",\n  \"map_rules_count.png\" = \"Mapa de complejidad normativa\",\n  \"tarifas_mapa_urbano.png\" = \"Mapa de tarifas urbanas\",\n  \"tarifas_mapa_rural.png\" = \"Mapa de tarifas rurales\"\n)\n\ncat(\"## Visualizaciones del contexto departamental\\n\\n\")\nfor (i in seq_along(img_generales)) {\n  img_path <- paste0(\"img_estatutos/\", names(img_generales)[i])\n  if (file.exists(img_path)) {\n    cat(\"- [\", img_generales[i], \"](\", img_path, \")\\n\")\n  }\n}\n```\n\n# Documentos de referencia\n\n```{r}\n#| echo: false\n#| results: asis\n\ncat(\"## Estatutos y documentos fuente\\n\\n\")\n\nif (nrow(freq_cat) > 0 && \"enlace_pdf\" %in% names(freq_cat)) {\n  enlaces_disponibles <- freq_cat %>% \n    filter(enlace_pdf != \"No disponible\") %>%\n    nrow()\n  \n  if (enlaces_disponibles > 0) {\n    cat(\"Se han identificado \", enlaces_disponibles, \" documentos fuente para este municipio. \")\n    cat(\"Los enlaces de descarga están disponibles en la tabla de estatutos al inicio de este documento.\\n\\n\")\n  } else {\n    cat(\"Los documentos fuente están en proceso de digitalización.\\n\\n\")\n  }\n} else {\n  cat(\"Los documentos fuente están en proceso de digitalización.\\n\\n\")\n}\n\ncat(\"## Metodología del análisis\\n\\n\")\ncat(\"Este análisis forma parte del proyecto de sistematización de estatutos tributarios de Antioquia, que incluye:\\n\\n\")\ncat(\"1. **Transcripción normativa:** Conversión de estatutos físicos a formato digital estructurado\\n\")\ncat(\"2. **Categorización:** Identificación de criterios tarifarios (avalúo, área, destino, estrato)\\n\")\ncat(\"3. **Análisis de progresividad:** Evaluación de la coherencia y equidad del sistema tarifario\\n\")\ncat(\"4. **Comparación intermunicipal:** Benchmarking con otros municipios del departamento\\n\\n\")\ncat(\"Para más información sobre la metodología completa, consulte el [análisis departamental](estatuto_index.html).\\n\")\n```\n\n# Resumen visual integrado\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 12\n#| fig-height: 8\n\n# Solo generar si hay datos de transcripciones\ntryCatch({\n  bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n  datos_resumen <- bd_transcripciones %>%\n    filter(codigo_dane == params$cod_dane)\n  \n  if (nrow(datos_resumen) > 0) {\n    cat(\"## Dashboard de análisis tributario\\n\\n\")\n    cat(\"Este resumen integra los principales hallazgos del análisis tributario de \", params$nombre, \":\\n\\n\")\n    \n    # Crear un layout de múltiples gráficos si hay suficientes datos\n    tryCatch({\n      library(gridExtra)\n      library(grid)\n      use_grid <- TRUE\n    }, error = function(e) {\n      use_grid <- FALSE\n    })\n    \n    plots_list <- list()\n    \n    # 1. Gráfico de tarifas mejorado con box plot y violin plot\n    datos_tarifas_res <- datos_resumen %>% filter(!is.na(tarifa), tarifa > 0)\n    if (nrow(datos_tarifas_res) > 1) {\n      p1 <- ggplot(datos_tarifas_res, aes(x = \"\", y = tarifa)) +\n        geom_violin(fill = \"lightblue\", alpha = 0.5, color = \"blue\") +\n        geom_boxplot(fill = \"lightblue\", alpha = 0.8, width = 0.3, \n                     outlier.color = \"red\", outlier.size = 2) +\n        geom_jitter(width = 0.1, alpha = 0.6, color = \"darkblue\", size = 1.5) +\n        stat_summary(fun = mean, geom = \"point\", shape = 18, size = 4, color = \"orange\") +\n        labs(\n          title = \"Distribución de tarifas\", \n          subtitle = paste(\"🔵 Datos | 📦 Cuartiles | 🟠 Promedio | 🔴 Outliers\"),\n          y = \"Tarifa (‰)\", \n          x = \"\"\n        ) +\n        theme_minimal() +\n        theme(\n          plot.title = element_text(size = 12, face = \"bold\"),\n          plot.subtitle = element_text(size = 9, color = \"gray50\"),\n          axis.text.x = element_blank(),\n          axis.ticks.x = element_blank()\n        )\n      plots_list <- append(plots_list, list(p1))\n    }\n    \n    # 2. Gráfico de progresividad por avalúo si hay datos\n    datos_avaluo_res <- datos_resumen %>%\n      filter(!is.na(avaluo_desde) | !is.na(avaluo_hasta)) %>%\n      filter(!is.na(tarifa)) %>%\n      mutate(\n        avaluo_medio = case_when(\n          !is.na(avaluo_desde) & !is.na(avaluo_hasta) ~ (avaluo_desde + avaluo_hasta) / 2,\n          !is.na(avaluo_desde) ~ avaluo_desde,\n          !is.na(avaluo_hasta) ~ avaluo_hasta,\n          TRUE ~ NA_real_\n        )\n      ) %>%\n      filter(!is.na(avaluo_medio)) %>%\n      arrange(avaluo_medio)\n    \n    if (nrow(datos_avaluo_res) >= 3) {\n      # Calcular R² para mostrar calidad del ajuste\n      modelo_temp <- lm(tarifa ~ log10(avaluo_medio), data = datos_avaluo_res)\n      r_squared <- round(summary(modelo_temp)$r.squared, 3)\n      \n      p2 <- ggplot(datos_avaluo_res, aes(x = avaluo_medio, y = tarifa)) +\n        geom_point(aes(size = avaluo_medio), color = \"darkblue\", alpha = 0.7) +\n        geom_smooth(method = \"lm\", se = TRUE, color = \"red\", linetype = \"dashed\", alpha = 0.3) +\n        geom_smooth(method = \"loess\", se = FALSE, color = \"green\", size = 1, alpha = 0.8) +\n        scale_x_continuous(\n          trans = \"log10\", \n          labels = scales::comma_format(scale = 1e-6, suffix = \"M\"),\n          breaks = scales::trans_breaks(\"log10\", function(x) 10^x, n = 4)\n        ) +\n        scale_size_continuous(guide = \"none\", range = c(1, 4)) +\n        labs(\n          title = \"Progresividad por avalúo\", \n          subtitle = paste(\"🔴 Tendencia lineal (R²=\", r_squared, \") | 🟢 Tendencia suavizada\"),\n          x = \"Avalúo (UVT)\", \n          y = \"Tarifa (‰)\"\n        ) +\n        theme_minimal() +\n        theme(\n          plot.title = element_text(size = 12, face = \"bold\"),\n          plot.subtitle = element_text(size = 9, color = \"gray50\")\n        )\n      plots_list <- append(plots_list, list(p2))\n    }\n    \n    # 3. Gráfico de criterios utilizados\n    criterios_summary <- datos_resumen %>%\n      summarise(\n        Avalúo = sum(!is.na(avaluo_desde) | !is.na(avaluo_hasta)),\n        Área = sum(!is.na(area_desde) | !is.na(area_hasta)),\n        Destino = sum(!is.na(destino) & destino != \"\", na.rm = TRUE),\n        Estrato = sum(!is.na(estrato) & estrato != \"\", na.rm = TRUE),\n        Zona = sum(!is.na(zona) & zona != \"\", na.rm = TRUE)\n      ) %>%\n      tidyr::pivot_longer(everything(), names_to = \"Criterio\", values_to = \"Frecuencia\") %>%\n      filter(Frecuencia > 0)\n    \n    if (nrow(criterios_summary) > 0) {\n      p3 <- ggplot(criterios_summary, aes(x = reorder(Criterio, Frecuencia), y = Frecuencia)) +\n        geom_col(fill = \"darkgreen\", alpha = 0.7) +\n        coord_flip() +\n        labs(title = \"Criterios utilizados\", x = \"Criterio\", y = \"Número de reglas\") +\n        theme_minimal() +\n        theme(plot.title = element_text(size = 12, face = \"bold\"))\n      plots_list <- append(plots_list, list(p3))\n    }\n    \n    # Mostrar gráficos\n    if (length(plots_list) > 0) {\n      if (use_grid && length(plots_list) > 1) {\n        # Usar grid si está disponible\n        if (length(plots_list) == 2) {\n          grid.arrange(grobs = plots_list, ncol = 2)\n        } else if (length(plots_list) >= 3) {\n          grid.arrange(grobs = plots_list, ncol = 2, nrow = 2)\n        }\n      } else {\n        # Mostrar gráficos individualmente\n        for (i in seq_along(plots_list)) {\n          print(plots_list[[i]])\n        }\n      }\n      \n      cat(\"\\n**🎯 Interpretación integral del dashboard:**\\n\")\n      cat(\"Este dashboard proporciona una **visión 360° del sistema tributario** de \", params$nombre, \", integrando múltiples dimensiones analíticas:\\n\\n\")\n      \n      # Análisis integrado más sofisticado\n      cat(\"**📊 Resumen ejecutivo:**\\n\")\n      total_reglas <- nrow(datos_resumen)\n      complejidad_score <- 0\n      \n      # Calcular score de complejidad\n      if (nrow(criterios_summary) > 0) {\n        complejidad_score <- complejidad_score + (nrow(criterios_summary) * 20)\n      }\n      if (nrow(datos_tarifas_res) > 0) {\n        n_tarifas_unicas <- length(unique(datos_tarifas_res$tarifa))\n        complejidad_score <- complejidad_score + min(n_tarifas_unicas * 5, 50)\n        cv_tarifas <- sd(datos_tarifas_res$tarifa) / mean(datos_tarifas_res$tarifa)\n        if (cv_tarifas > 0.5) complejidad_score <- complejidad_score + 30\n      }\n      \n      cat(\"- **📈 Complejidad normativa:** \")\n      if (complejidad_score >= 80) {\n        cat(\"ALTA (score: \", complejidad_score, \") - Sistema muy sofisticado\\n\")\n      } else if (complejidad_score >= 50) {\n        cat(\"MODERADA (score: \", complejidad_score, \") - Sistema equilibrado\\n\")\n      } else {\n        cat(\"BAJA (score: \", complejidad_score, \") - Sistema simplificado\\n\")\n      }\n      \n      cat(\"- **🔢 Total de reglas analizadas:** \", total_reglas, \"\\n\")\n      \n      if (nrow(datos_tarifas_res) > 0) {\n        tarifa_promedio <- round(mean(datos_tarifas_res$tarifa), 2)\n        tarifa_mediana <- round(median(datos_tarifas_res$tarifa), 2)\n        dispersion <- round(sd(datos_tarifas_res$tarifa) / mean(datos_tarifas_res$tarifa), 3)\n        \n        cat(\"- **💰 Estructura tarifaria:**\\n\")\n        cat(\"  - Tarifas únicas: \", length(unique(datos_tarifas_res$tarifa)), \"\\n\")\n        cat(\"  - Tarifa típica: \", tarifa_mediana, \"‰ (mediana)\\n\")\n        cat(\"  - Rango: \", min(datos_tarifas_res$tarifa), \"‰ - \", max(datos_tarifas_res$tarifa), \"‰\\n\")\n        cat(\"  - Uniformidad: \", if(dispersion < 0.3) \"Alta\" else if(dispersion < 0.7) \"Moderada\" else \"Baja\", \" (CV: \", dispersion, \")\\n\")\n      }\n      \n      if (nrow(criterios_summary) > 0) {\n        criterio_principal <- criterios_summary$Criterio[which.max(criterios_summary$Frecuencia)]\n        cat(\"- **🎯 Criterios tarifarios activos:** \", nrow(criterios_summary), \"\\n\")\n        cat(\"  - Criterio principal: \", criterio_principal, \" (\", max(criterios_summary$Frecuencia), \" reglas)\\n\")\n      }\n      \n      # Análisis de progresividad si hay datos de avalúo\n      if (nrow(datos_avaluo_res) >= 3) {\n        cor_avaluo <- cor(datos_avaluo_res$avaluo_medio, datos_avaluo_res$tarifa, method = \"spearman\")\n        cat(\"- **📈 Progresividad por avalúo:** \")\n        if (cor_avaluo > 0.7) {\n          cat(\"ALTA (r=\", round(cor_avaluo, 2), \") - Sistema muy progresivo\\n\")\n        } else if (cor_avaluo > 0.3) {\n          cat(\"MODERADA (r=\", round(cor_avaluo, 2), \") - Progresividad parcial\\n\")\n        } else if (cor_avaluo > -0.3) {\n          cat(\"VARIABLE (r=\", round(cor_avaluo, 2), \") - Sin patrón claro\\n\")\n        } else {\n          cat(\"REGRESIVA (r=\", round(cor_avaluo, 2), \") - Tarifa decrece con avalúo\\n\")\n        }\n      }\n      \n      cat(\"\\n**🔍 Recomendaciones basadas en el análisis:**\\n\")\n      if (complejidad_score >= 80) {\n        cat(\"- Considerar **simplificación** del esquema tarifario\\n\")\n        cat(\"- Implementar **herramientas digitales** para facilitar aplicación\\n\")\n      } else if (complejidad_score < 30) {\n        cat(\"- Evaluar si el esquema actual **captura adecuadamente** la capacidad contributiva\\n\")\n        cat(\"- Considerar mayor **diferenciación** tarifaria si es viable\\n\")\n      } else {\n        cat(\"- Mantener **equilibrio actual** entre simplicidad y equidad\\n\")\n        cat(\"- Realizar **revisiones periódicas** del esquema\\n\")\n      }\n      \n      if (nrow(datos_tarifas_res) > 0 && sd(datos_tarifas_res$tarifa) / mean(datos_tarifas_res$tarifa) > 1) {\n        cat(\"- **Alta dispersión** detectada: revisar coherencia entre tarifas\\n\")\n      }\n    }\n    \n  } else {\n    cat(\"No hay suficientes datos para generar el dashboard visual.\\n\")\n  }\n  \n}, error = function(e) {\n  cat(\"*Dashboard visual no disponible para este municipio.*\\n\")\n})\n```\n\n# Estadísticas avanzadas del municipio\n\n```{r}\n#| echo: false\n#| results: asis\n\nif (nrow(datos_municipio) > 0) {\n  cat(\"## Análisis temporal de la normativa\\n\\n\")\n  \n  # Análisis temporal si hay datos de año\n  if (\"anio\" %in% names(datos_municipio) && any(!is.na(datos_municipio$anio))) {\n    # Evolución temporal\n    evolucion <- datos_municipio %>%\n      filter(!is.na(anio)) %>%\n      count(anio, sort = TRUE)\n    \n    if (nrow(evolucion) > 1) {\n      cat(\"### Evolución de la actividad normativa\\n\\n\")\n      anos_activos <- evolucion$anio\n      cat(\"- **Años con mayor actividad normativa:** \", paste(head(anos_activos, 3), collapse = \", \"), \"\\n\")\n      cat(\"- **Período de mayor estabilidad:** \")\n      \n      # Buscar períodos sin cambios\n      gaps <- diff(anos_activos)\n      if (any(gaps > 1)) {\n        cat(\"Se observan períodos de estabilidad normativa entre algunos años\\n\")\n      } else {\n        cat(\"Actividad normativa continua en el período analizado\\n\")\n      }\n      \n      # Tabla de evolución\n      cat(\"\\n\")\n      kable(evolucion, \n            col.names = c(\"Año\", \"Número de registros\"),\n            caption = \"Evolución temporal de la normativa tributaria\")\n      cat(\"\\n\")\n    }\n  }\n  \n  # Análisis de tipos de normativa\n  if (\"tipo\" %in% names(datos_municipio) && any(!is.na(datos_municipio$tipo))) {\n    cat(\"## Tipología normativa\\n\\n\")\n    \n    tipos_freq <- datos_municipio %>%\n      filter(!is.na(tipo)) %>%\n      count(tipo, sort = TRUE)\n    \n    if (nrow(tipos_freq) > 0) {\n      cat(\"### Distribución por tipo de normativa\\n\\n\")\n      kable(tipos_freq, \n            col.names = c(\"Tipo de normativa\", \"Frecuencia\"),\n            caption = \"Tipos de instrumentos normativos utilizados\")\n      cat(\"\\n\")\n      \n      tipo_principal <- tipos_freq$tipo[1]\n      freq_principal <- tipos_freq$n[1]\n      porcentaje_principal <- round((freq_principal / nrow(datos_municipio)) * 100, 1)\n      \n      cat(\"- **Instrumento normativo predominante:** \", tipo_principal, \n          \" (\", freq_principal, \" registros, \", porcentaje_principal, \"%)\\n\")\n    }\n  }\n  \n  # Comparación con promedios departamentales\n  cat(\"## Comparación departamental\\n\\n\")\n  \n  # Estadísticas departamentales\n  stats_dpto <- bd_estatutos %>%\n    group_by(codigo_dane) %>%\n    summarise(\n      total_registros = n(),\n      .groups = 'drop'\n    )\n  \n  promedio_dpto <- mean(stats_dpto$total_registros, na.rm = TRUE)\n  mediana_dpto <- median(stats_dpto$total_registros, na.rm = TRUE)\n  \n  registros_municipio <- nrow(datos_municipio)\n  \n  cat(\"- **Registros de este municipio:** \", registros_municipio, \"\\n\")\n  cat(\"- **Promedio departamental:** \", round(promedio_dpto, 1), \"\\n\")\n  cat(\"- **Mediana departamental:** \", round(mediana_dpto, 1), \"\\n\")\n  \n  # Clasificación relativa\n  if (registros_municipio > promedio_dpto) {\n    cat(\"- **Clasificación:** Por encima del promedio departamental (\", \n        round((registros_municipio - promedio_dpto) / promedio_dpto * 100, 1), \n        \"% más registros)\\n\")\n  } else {\n    cat(\"- **Clasificación:** Por debajo del promedio departamental (\", \n        round((promedio_dpto - registros_municipio) / promedio_dpto * 100, 1), \n        \"% menos registros)\\n\")\n  }\n  \n  # Percentil\n  percentil <- round(sum(stats_dpto$total_registros <= registros_municipio) / nrow(stats_dpto) * 100, 1)\n  cat(\"- **Percentil departamental:** \", percentil, \"% (\", \n      round(100 - percentil, 1), \"% de municipios tienen más registros)\\n\")\n\n} else {\n  cat(\"No hay datos suficientes para generar estadísticas avanzadas.\\n\")\n}\n```\n\n# Recomendaciones específicas\n\n```{r}\n#| echo: false\n#| results: asis\n\nif (nrow(datos_municipio) > 0) {\n  cat(\"## Recomendaciones de política tributaria\\n\\n\")\n  \n  # Generar recomendaciones basadas en las características del municipio\n  registros_municipio <- nrow(datos_municipio)\n  \n  # Obtener estadísticas para comparación\n  stats_dpto <- bd_estatutos %>%\n    group_by(codigo_dane) %>%\n    summarise(total_registros = n(), .groups = 'drop')\n  \n  promedio_dpto <- mean(stats_dpto$total_registros, na.rm = TRUE)\n  cuartil_superior <- quantile(stats_dpto$total_registros, 0.75, na.rm = TRUE)\n  cuartil_inferior <- quantile(stats_dpto$total_registros, 0.25, na.rm = TRUE)\n  \n  cat(\"Basándose en el análisis comparativo, se sugieren las siguientes recomendaciones:\\n\\n\")\n  \n  if (registros_municipio > cuartil_superior) {\n    cat(\"### Simplificación normativa (Alta complejidad)\\n\\n\")\n    cat(\"- **Revisión integral:** Considerar la consolidación de reglas similares para reducir complejidad administrativa\\n\")\n    cat(\"- **Digitalización:** Implementar herramientas digitales para facilitar el cálculo y aplicación de tarifas\\n\")\n    cat(\"- **Capacitación:** Fortalecer las competencias técnicas del personal tributario\\n\")\n    cat(\"- **Comunicación:** Desarrollar material didáctico para facilitar el entendimiento ciudadano\\n\\n\")\n  } else if (registros_municipio < cuartil_inferior) {\n    cat(\"### Optimización del potencial tributario (Baja complejidad)\\n\\n\")\n    cat(\"- **Análisis de brechas:** Evaluar si la simplicidad actual captura adecuadamente la capacidad contributiva\\n\")\n    cat(\"- **Benchmarking:** Considerar mejores prácticas de municipios similares\\n\")\n    cat(\"- **Progresividad:** Evaluar la implementación de esquemas más progresivos si es técnicamente viable\\n\")\n    cat(\"- **Actualización:** Revisar la vigencia y pertinencia de las tarifas actuales\\n\\n\")\n  } else {\n    cat(\"### Optimización del esquema actual (Complejidad media)\\n\\n\")\n    cat(\"- **Eficiencia:** Evaluar la efectividad del esquema actual en términos de recaudo y equidad\\n\")\n    cat(\"- **Actualización periódica:** Establecer cronogramas regulares de revisión normativa\\n\")\n    cat(\"- **Monitoreo:** Implementar indicadores de seguimiento a la aplicación de tarifas\\n\")\n    cat(\"- **Participación:** Involucrar a la ciudadanía en procesos de actualización normativa\\n\\n\")\n  }\n  \n  cat(\"### Recomendaciones generales\\n\\n\")\n  cat(\"- **Transparencia:** Publicar de manera clara y accesible todas las tarifas vigentes\\n\")\n  cat(\"- **Tecnología:** Aprovechar herramientas digitales para mejorar la gestión tributaria\\n\")\n  cat(\"- **Equidad:** Evaluar periódicamente el impacto distributivo del sistema tarifario\\n\")\n  cat(\"- **Coordinación:** Mantener coherencia con las políticas tributarias departamentales\\n\\n\")\n  \n} else {\n  cat(\"Para generar recomendaciones específicas se requieren datos adicionales del municipio.\\n\")\n}\n```","srcMarkdownNoYaml":"\n\n\nEste proyecto presenta un análisis exhaustivo de los estatutos tributarios del municipio de \nPara el análisis del municipio de , enfocándose específicamente en la estructura del impuesto predial. El estatuto fue acompañado de un análisis jurídico y de contenido detallado del capítulo de impuestos prediales contenido en sus estatutos de rentas.\n\nPara el análisis del municipio se tuvieron  en cuenta los siguientes estatutos y modificaciones:\n\n```{r}\n#| echo: false\n#| message: false\n#| warning: false\n\n# Función para leer archivos RDS con rutas relativas\nlee_rds <- function(rel){\n  candidatos <- c(rel, file.path('..', rel), file.path('..','..', rel))\n  existente <- candidatos[file.exists(candidatos)][1]\n  if(is.na(existente)) stop('No se encontró ', rel, ' en rutas: ', paste(candidatos, collapse=', '))\n  readRDS(existente)\n}\n\n# Cargar librerías necesarias\nlibrary(dplyr)\nlibrary(knitr)\nlibrary(ggplot2)\nlibrary(scales)\nsuppressPackageStartupMessages({\n  library(gridExtra, quietly = TRUE)\n  library(grid, quietly = TRUE)\n  library(tidyr, quietly = TRUE)\n})\n\n# Configurar opciones de gráficos\noptions(scipen = 999)  # Evitar notación científica\n\n# Cargar datos completos con manejo de ausencia del archivo\ndatos_disponibles <- TRUE\nbd_estatutos <- NULL\ntryCatch({\n  bd_estatutos <- lee_rds(\"ds_estatutos/BD_Estatutos.rds\")\n}, error = function(e){\n  datos_disponibles <<- FALSE\n  mensaje <- paste0(\"⚠️ No se encontró el dataset 'BD_Estatutos.rds'. Se mostrará una versión reducida del informe. Detalle: \", e$message)\n  message(mensaje)\n  cat(mensaje, \"\\n\\n\")\n})\n\n# Filtrar para el municipio específico (si hay datos)\nif (datos_disponibles) {\n  datos_municipio <- bd_estatutos %>% filter(codigo_dane == params$cod_dane)\n} else {\n  datos_municipio <- data.frame()\n}\n\n# Tabla de estatutos\nfreq_cat <- datos_municipio %>%\n  mutate(\n    filename = if ('filename' %in% names(cur_data_all())) filename else NA_character_,\n    enlace_pdf = if_else(!is.na(filename) & filename != \"\", \n                         paste0(\"[Descargar PDF](pdfs/\", filename, \")\"), \n                         \"No disponible\")\n  ) %>%\n  select(any_of(c(\"mpio\",\"anio\",\"tipo\",\"numero\",\"observaciones\",\"enlace_pdf\")))\n\nif (nrow(freq_cat) == 0) {\n  cat(\"No hay estatutos registrados para este municipio.\\n\")\n} else {\n  knitr::kable(head(freq_cat, 200), caption = \"Estatutos Usados para el Estudio\", escape = FALSE)\n}\n```\n\n\nPara ver más análisis agregados y los detalles metodológicos puede visitar este enlace [(ir)](https://jcmunozmora.github.io/estatutos_analisis/).\n\n# Estadísticas del municipio\n\n```{r}\n#| echo: false\n#| message: false\n#| warning: false\n\nif (nrow(datos_municipio) > 0) {\n  # Estadísticas básicas\n  cat(\"## Resumen estadístico\\n\\n\")\n  cat(\"- **Total de registros analizados:** \", nrow(datos_municipio), \"\\n\")\n  \n  if (\"anio\" %in% names(datos_municipio)) {\n    anos_unicos <- sort(unique(datos_municipio$anio[!is.na(datos_municipio$anio)]))\n    if (length(anos_unicos) > 0) {\n      cat(\"- **Período analizado:** \", min(anos_unicos), \" - \", max(anos_unicos), \"\\n\")\n      cat(\"- **Años con estatutos:** \", paste(anos_unicos, collapse = \", \"), \"\\n\")\n    }\n  }\n  \n  if (\"tipo\" %in% names(datos_municipio)) {\n    tipos_unicos <- unique(datos_municipio$tipo[!is.na(datos_municipio$tipo)])\n    if (length(tipos_unicos) > 0) {\n      cat(\"- **Tipos de normativa:** \", paste(tipos_unicos, collapse = \", \"), \"\\n\")\n    }\n  }\n  \n  # Comparación con el departamento\n  total_departamento <- nrow(bd_estatutos)\n  porcentaje <- round((nrow(datos_municipio) / total_departamento) * 100, 2)\n  cat(\"- **Representación en el estudio:** \", porcentaje, \"% del total departamental\\n\")\n  \n} else {\n  cat(\"No hay datos disponibles para generar estadísticas.\\n\")\n}\n```\n\n# Análisis de estructura tarifaria\n\n## Combinaciones de criterios tarifarios\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 10\n#| fig-height: 6\n\n# Verificar si existe la imagen de combinaciones para este municipio\nimg_combos <- paste0(\"img_estatutos/\", params$cod_dane, \"_combos.png\")\n\nif (file.exists(img_combos)) {\n  cat(\"Este gráfico muestra las diferentes combinaciones de criterios utilizados en la estructura tarifaria del municipio:\\n\\n\")\n  cat(\"![Combinaciones de criterios tarifarios](\", img_combos, \"){width=90%}\\n\\n\")\n  cat(\"**Descripción:** Visualización de las combinaciones de criterios (avalúo, área, destino, estrato, etc.) utilizadas para determinar las tarifas prediales en \", params$nombre, \".\\n\\n\")\n  cat(\"**Interpretación:** Cada combinación representa una regla específica del estatuto tributario. Mayor número de combinaciones indica mayor complejidad normativa.\\n\\n\")\n} else {\n  # Generar análisis dinámico desde los datos\n  cat(\"### Análisis de criterios tarifarios (generado dinámicamente)\\n\\n\")\n  \n  tryCatch({\n    bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n    \n    # Filtrar datos del municipio\n    datos_criterios <- bd_transcripciones %>%\n      filter(codigo_dane == params$cod_dane)\n    \n    if (nrow(datos_criterios) > 0) {\n      library(ggplot2)\n      library(dplyr)\n      \n      # Analizar qué criterios se utilizan\n      criterios_utilizados <- datos_criterios %>%\n        summarise(\n          usa_avaluo = any(!is.na(avaluo_desde) | !is.na(avaluo_hasta)),\n          usa_area = any(!is.na(area_desde) | !is.na(area_hasta)),\n          usa_destino = any(!is.na(destino) & destino != \"\"),\n          usa_estrato = any(!is.na(estrato) & estrato != \"\"),\n          usa_zona = any(!is.na(zona) & zona != \"\")\n        )\n      \n      # Crear resumen de criterios\n      criterios_activos <- c()\n      if (criterios_utilizados$usa_avaluo) criterios_activos <- c(criterios_activos, \"Avalúo\")\n      if (criterios_utilizados$usa_area) criterios_activos <- c(criterios_activos, \"Área\")\n      if (criterios_utilizados$usa_destino) criterios_activos <- c(criterios_activos, \"Destino\")\n      if (criterios_utilizados$usa_estrato) criterios_activos <- c(criterios_activos, \"Estrato\")\n      if (criterios_utilizados$usa_zona) criterios_activos <- c(criterios_activos, \"Zona\")\n      \n      cat(\"**Criterios tarifarios identificados:**\\n\")\n      if (length(criterios_activos) > 0) {\n        for (criterio in criterios_activos) {\n          cat(\"- ✓ \", criterio, \"\\n\")\n        }\n      } else {\n        cat(\"- No se identificaron criterios específicos en los datos disponibles\\n\")\n      }\n      cat(\"\\n\")\n      \n      # Análisis de combinaciones más frecuentes\n      if (length(criterios_activos) > 1) {\n        # Crear combinaciones de criterios\n        combinaciones <- datos_criterios %>%\n          mutate(\n            combinacion = paste(\n              ifelse(!is.na(avaluo_desde) | !is.na(avaluo_hasta), \"Avalúo\", \"\"),\n              ifelse(!is.na(area_desde) | !is.na(area_hasta), \"Área\", \"\"),\n              ifelse(!is.na(destino) & destino != \"\", \"Destino\", \"\"),\n              ifelse(!is.na(estrato) & estrato != \"\", \"Estrato\", \"\"),\n              ifelse(!is.na(zona) & zona != \"\", \"Zona\", \"\"),\n              sep = \"+\"\n            )\n          ) %>%\n          mutate(combinacion = gsub(\"\\\\+{2,}\", \"+\", combinacion)) %>%\n          mutate(combinacion = gsub(\"^\\\\+|\\\\+$\", \"\", combinacion)) %>%\n          filter(combinacion != \"\") %>%\n          count(combinacion, sort = TRUE)\n        \n        if (nrow(combinaciones) > 0) {\n          cat(\"**Combinaciones de criterios más frecuentes:**\\n\")\n          for (i in 1:min(5, nrow(combinaciones))) {\n            cat(\"- \", combinaciones$combinacion[i], \": \", combinaciones$n[i], \" reglas\\n\")\n          }\n          cat(\"\\n\")\n          \n          # Gráfico de barras de combinaciones\n          if (nrow(combinaciones) > 1) {\n            p_combos <- ggplot(head(combinaciones, 10), aes(x = reorder(combinacion, n), y = n)) +\n              geom_col(fill = \"steelblue\", alpha = 0.8) +\n              coord_flip() +\n              labs(\n                title = paste(\"Combinaciones de criterios tarifarios -\", params$nombre),\n                subtitle = \"Top 10 combinaciones más utilizadas\",\n                x = \"Combinación de criterios\",\n                y = \"Número de reglas\",\n                caption = \"Fuente: Análisis de estatutos tributarios\"\n              ) +\n              theme_minimal() +\n              theme(\n                plot.title = element_text(size = 14, face = \"bold\"),\n                plot.subtitle = element_text(size = 12),\n                axis.title = element_text(size = 11)\n              )\n            \n            print(p_combos)\n          }\n        }\n      }\n      \n      # Estadísticas de complejidad\n      cat(\"\\n**Análisis de complejidad normativa:**\\n\")\n      cat(\"- **Total de reglas analizadas:** \", nrow(datos_criterios), \"\\n\")\n      cat(\"- **Número de criterios utilizados:** \", length(criterios_activos), \"\\n\")\n      \n      if (length(criterios_activos) >= 3) {\n        cat(\"- **Clasificación:** Sistema de alta complejidad (múltiples criterios)\\n\")\n      } else if (length(criterios_activos) == 2) {\n        cat(\"- **Clasificación:** Sistema de complejidad moderada\\n\")\n      } else {\n        cat(\"- **Clasificación:** Sistema de baja complejidad (criterio único o simple)\\n\")\n      }\n      \n    } else {\n      cat(\"No se encontraron datos de criterios tarifarios para este municipio.\\n\")\n    }\n    \n  }, error = function(e) {\n    cat(\"*No fue posible generar el análisis de criterios tarifarios para este municipio.*\\n\")\n    cat(\"*Motivo: Datos de transcripción no disponibles o incompletos.*\\n\")\n  })\n}\n```\n\n## Distribución de tarifas\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 10\n#| fig-height: 6\n\n# Verificar si existe la imagen de distribución de tarifas\nimg_tarifas <- paste0(\"img_estatutos/\", params$cod_dane, \"_dist_tarifas.png\")\n\nif (file.exists(img_tarifas)) {\n  cat(\"La distribución de tarifas muestra el rango y frecuencia de las diferentes tarifas prediales establecidas:\\n\\n\")\n  cat(\"![Distribución de tarifas prediales](\", img_tarifas, \"){width=90%}\\n\\n\")\n  cat(\"**Descripción:** Histograma que muestra la distribución de las tarifas prediales por mil (‰) establecidas en el estatuto de \", params$nombre, \".\\n\\n\")\n  cat(\"**Interpretación:** La forma de la distribución indica si el municipio tiende hacia tarifas uniformes (distribución concentrada) o hacia un esquema más diversificado (distribución dispersa).\\n\\n\")\n} else {\n  # Generar gráfico dinámico desde los datos\n  cat(\"### Distribución de tarifas prediales (generado dinámicamente)\\n\\n\")\n  \n  tryCatch({\n    bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n    \n    # Filtrar datos del municipio\n    datos_tarifas <- bd_transcripciones %>%\n      filter(codigo_dane == params$cod_dane) %>%\n      filter(!is.na(tarifa), tarifa > 0)\n    \n    if (nrow(datos_tarifas) > 0) {\n      library(ggplot2)\n      \n      # Crear histograma de distribución de tarifas mejorado\n      p_dist <- ggplot(datos_tarifas, aes(x = tarifa)) +\n        geom_histogram(aes(y = after_stat(density)), \n                       bins = min(30, max(5, nrow(datos_tarifas)/3)), \n                       fill = \"lightblue\", color = \"darkblue\", alpha = 0.7, size = 0.3) +\n        geom_density(alpha = 0.3, fill = \"blue\", color = \"blue\", size = 1) +\n        geom_vline(aes(xintercept = median(tarifa)), \n                   color = \"red\", linetype = \"dashed\", size = 1.2) +\n        geom_vline(aes(xintercept = mean(tarifa)), \n                   color = \"orange\", linetype = \"dashed\", size = 1.2) +\n        geom_vline(aes(xintercept = quantile(tarifa, 0.25)), \n                   color = \"purple\", linetype = \"dotted\", size = 0.8, alpha = 0.7) +\n        geom_vline(aes(xintercept = quantile(tarifa, 0.75)), \n                   color = \"purple\", linetype = \"dotted\", size = 0.8, alpha = 0.7) +\n        scale_x_continuous(\n          labels = scales::number_format(suffix = \"‰\"),\n          name = \"Tarifa predial (por mil)\"\n        ) +\n        scale_y_continuous(\n          name = \"Densidad de probabilidad\",\n          labels = scales::number_format(accuracy = 0.01)\n        ) +\n        labs(\n          title = paste(\"Distribución de tarifas prediales -\", params$nombre),\n          subtitle = \"🔴 Mediana | 🟠 Promedio | 🟣 Cuartiles (P25, P75) | 🔵 Curva de densidad\",\n          caption = \"Análisis de concentración y dispersión tarifaria\"\n        ) +\n        theme_minimal() +\n        theme(\n          plot.title = element_text(size = 14, face = \"bold\", color = \"darkblue\"),\n          plot.subtitle = element_text(size = 10, color = \"gray40\"),\n          plot.caption = element_text(size = 9, color = \"gray50\"),\n          axis.title = element_text(size = 11),\n          panel.grid.minor = element_blank(),\n          panel.grid.major = element_line(color = \"gray90\", size = 0.5)\n        )\n      \n      print(p_dist)\n      \n      # Estadísticas descriptivas mejoradas\n      tarifas_unicas <- unique(datos_tarifas$tarifa)\n      rango_tarifas <- max(datos_tarifas$tarifa) - min(datos_tarifas$tarifa)\n      q10 <- quantile(datos_tarifas$tarifa, 0.1)\n      q90 <- quantile(datos_tarifas$tarifa, 0.9)\n      asimetria <- round((mean(datos_tarifas$tarifa) - median(datos_tarifas$tarifa)) / sd(datos_tarifas$tarifa), 3)\n      \n      cat(\"\\n**Estadísticas descriptivas detalladas:**\\n\")\n      cat(\"- **Número total de tarifas diferentes:** \", length(tarifas_unicas), \"\\n\")\n      cat(\"- **Rango de tarifas:** \", min(datos_tarifas$tarifa), \"‰ - \", max(datos_tarifas$tarifa), \"‰ (amplitud: \", round(rango_tarifas, 2), \"‰)\\n\")\n      cat(\"- **Medidas de tendencia central:**\\n\")\n      cat(\"  - Promedio: \", round(mean(datos_tarifas$tarifa), 2), \"‰\\n\")\n      cat(\"  - Mediana: \", round(median(datos_tarifas$tarifa), 2), \"‰\\n\")\n      cat(\"  - Moda: \", round(as.numeric(names(sort(table(datos_tarifas$tarifa), decreasing = TRUE))[1]), 2), \"‰\\n\")\n      cat(\"- **Medidas de dispersión:**\\n\")\n      cat(\"  - Desviación estándar: \", round(sd(datos_tarifas$tarifa), 2), \"‰\\n\")\n      cat(\"  - Coeficiente de variación: \", round(sd(datos_tarifas$tarifa)/mean(datos_tarifas$tarifa), 3), \"\\n\")\n      cat(\"  - Rango intercuartílico (P25-P75): \", round(quantile(datos_tarifas$tarifa, 0.75) - quantile(datos_tarifas$tarifa, 0.25), 2), \"‰\\n\")\n      cat(\"- **Percentiles clave:**\\n\")\n      cat(\"  - P10: \", round(q10, 2), \"‰ | P90: \", round(q90, 2), \"‰\\n\")\n      cat(\"- **Forma de la distribución:**\\n\")\n      cat(\"  - Asimetría: \", asimetria, if(asimetria > 0.5) \" (sesgada hacia la derecha)\" else if(asimetria < -0.5) \" (sesgada hacia la izquierda)\" else \" (aproximadamente simétrica)\", \"\\n\")\n      \n      # Análisis de dispersión con interpretación contextual\n      cv <- sd(datos_tarifas$tarifa)/mean(datos_tarifas$tarifa)\n      \n      cat(\"\\n**📊 Análisis de concentración tarifaria:**\\n\")\n      if (cv < 0.15) {\n        cat(\"- **Tipo de sistema:** UNIFORME - Las tarifas están muy concentradas\\n\")\n        cat(\"- **Ventajas:** Simplicidad administrativa, fácil comprensión ciudadana\\n\")\n        cat(\"- **Consideraciones:** Evaluar si captura diferencias en capacidad contributiva\\n\")\n      } else if (cv < 0.30) {\n        cat(\"- **Tipo de sistema:** MODERADAMENTE UNIFORME - Concentración con cierta variabilidad\\n\")\n        cat(\"- **Ventajas:** Balance entre simplicidad y diferenciación\\n\")\n        cat(\"- **Consideraciones:** Sistema equilibrado para contextos urbanos/rurales mixtos\\n\")\n      } else if (cv < 0.70) {\n        cat(\"- **Tipo de sistema:** DIVERSIFICADO - Amplio rango de tarifas\\n\")\n        cat(\"- **Ventajas:** Mayor precisión en la diferenciación contributiva\\n\")\n        cat(\"- **Consideraciones:** Requiere mayor capacidad técnica para aplicación\\n\")\n      } else {\n        cat(\"- **Tipo de sistema:** ALTAMENTE DIVERSIFICADO - Muy amplio espectro tarifario\\n\")\n        cat(\"- **Ventajas:** Máxima precisión en diferenciación\\n\")\n        cat(\"- **Consideraciones:** Alta complejidad administrativa, revisar coherencia\\n\")\n      }\n      \n      # Análisis de percentiles con interpretación\n      q25 <- quantile(datos_tarifas$tarifa, 0.25)\n      q75 <- quantile(datos_tarifas$tarifa, 0.75)\n      riq <- q75 - q25\n      cat(\"- **Rango central (P25-P75):** \", round(q25, 2), \"‰ - \", round(q75, 2), \"‰ (RIQ: \", round(riq, 2), \"‰)\\n\")\n      cat(\"- **Concentración central:** \", round((riq / median(datos_tarifas$tarifa)) * 100, 1), \"% de la mediana\\n\")\n      \n      # Detección de outliers\n      limite_inferior <- q25 - 1.5 * riq\n      limite_superior <- q75 + 1.5 * riq\n      outliers <- datos_tarifas$tarifa[datos_tarifas$tarifa < limite_inferior | datos_tarifas$tarifa > limite_superior]\n      \n      if (length(outliers) > 0) {\n        cat(\"- **⚠️ Valores atípicos detectados:** \", length(outliers), \" tarifas fuera del rango normal\\n\")\n        cat(\"  - Tarifas extremas: \", paste(round(sort(outliers), 2), collapse = \"‰, \"), \"‰\\n\")\n        cat(\"  - **Recomendación:** Revisar coherencia de estas tarifas excepcionales\\n\")\n      } else {\n        cat(\"- **✅ Sin valores atípicos:** Todas las tarifas están dentro del rango esperado\\n\")\n      }\n      \n    } else {\n      cat(\"No se encontraron datos de tarifas para este municipio.\\n\")\n    }\n    \n  }, error = function(e) {\n    cat(\"*No fue posible generar la distribución de tarifas para este municipio.*\\n\")\n    cat(\"*Motivo: Datos de transcripción no disponibles o incompletos.*\\n\")\n  })\n}\n```\n\n# Análisis de progresividad\n\n## Progresividad por avalúo\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 10\n#| fig-height: 6\n\n# Verificar si existe la imagen ladder de avalúo\nimg_avaluo <- paste0(\"img_estatutos/\", params$cod_dane, \"_ladder_avaluo.png\")\n\nif (file.exists(img_avaluo)) {\n  cat(\"El análisis de progresividad por avalúo evalúa si las tarifas aumentan proporcionalmente con el valor del predio:\\n\\n\")\n  cat(\"![Progresividad por avalúo](\", img_avaluo, \"){width=90%}\\n\\n\")\n  cat(\"**Descripción:** Gráfico ladder que muestra la relación entre rangos de avalúo (en UVT) y las tarifas correspondientes en \", params$nombre, \".\\n\\n\")\n  cat(\"**Interpretación:** Una tendencia ascendente consistente indica progresividad, donde predios de mayor valor pagan tarifas proporcionalmente más altas. Escalones horizontales indican tramos con tarifa fija.\\n\\n\")\n} else {\n  # Generar gráfico dinámico desde los datos\n  cat(\"### Análisis de progresividad por avalúo (generado dinámicamente)\\n\\n\")\n  \n  # Intentar cargar datos de transcripciones para análisis detallado\n  tryCatch({\n    bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n    \n    # Filtrar datos del municipio\n    datos_avaluo <- bd_transcripciones %>%\n      filter(codigo_dane == params$cod_dane) %>%\n      filter(!is.na(avaluo_desde) | !is.na(avaluo_hasta)) %>%\n      filter(!is.na(tarifa))\n    \n    if (nrow(datos_avaluo) > 0) {\n      library(ggplot2)\n      \n      # Preparar datos para gráfico\n      datos_plot <- datos_avaluo %>%\n        mutate(\n          avaluo_medio = case_when(\n            !is.na(avaluo_desde) & !is.na(avaluo_hasta) ~ (avaluo_desde + avaluo_hasta) / 2,\n            !is.na(avaluo_desde) ~ avaluo_desde,\n            !is.na(avaluo_hasta) ~ avaluo_hasta,\n            TRUE ~ NA_real_\n          ),\n          avaluo_desde = ifelse(is.na(avaluo_desde), 0, avaluo_desde),\n          avaluo_hasta = ifelse(is.na(avaluo_hasta), avaluo_medio * 2, avaluo_hasta)\n        ) %>%\n        filter(!is.na(avaluo_medio), !is.na(tarifa)) %>%\n        arrange(avaluo_medio)\n      \n      if (nrow(datos_plot) >= 2) {\n        # Crear gráfico ladder\n        p_avaluo <- ggplot(datos_plot, aes(x = avaluo_medio, y = tarifa)) +\n          geom_step(direction = \"hv\", color = \"steelblue\", size = 1.2) +\n          geom_point(color = \"darkblue\", size = 2) +\n          scale_x_continuous(\n            trans = \"log10\",\n            labels = scales::comma_format(scale = 1e-6, suffix = \"M\"),\n            name = \"Avalúo (UVT, escala logarítmica)\"\n          ) +\n          scale_y_continuous(\n            labels = scales::number_format(suffix = \"‰\"),\n            name = \"Tarifa predial (por mil)\"\n          ) +\n          labs(\n            title = paste(\"Progresividad por avalúo -\", params$nombre),\n            subtitle = \"Relación entre rangos de avalúo y tarifas prediales\",\n            caption = \"Fuente: Análisis de estatutos tributarios\"\n          ) +\n          theme_minimal() +\n          theme(\n            plot.title = element_text(size = 14, face = \"bold\"),\n            plot.subtitle = element_text(size = 12),\n            axis.title = element_text(size = 11),\n            panel.grid.minor = element_blank()\n          )\n        \n        print(p_avaluo)\n        \n        # Análisis de progresividad\n        correlacion <- cor(datos_plot$avaluo_medio, datos_plot$tarifa, method = \"spearman\")\n        n_intervalos <- nrow(datos_plot)\n        incrementos_positivos <- sum(diff(datos_plot$tarifa[order(datos_plot$avaluo_medio)]) > 0)\n        prop_progresiva <- round(incrementos_positivos / (n_intervalos - 1) * 100, 1)\n        \n        cat(\"\\n**Análisis estadístico:**\\n\")\n        cat(\"- **Número de intervalos analizados:** \", n_intervalos, \"\\n\")\n        cat(\"- **Correlación avalúo-tarifa (Spearman):** \", round(correlacion, 3), \"\\n\")\n        cat(\"- **Proporción de incrementos progresivos:** \", prop_progresiva, \"%\\n\")\n        \n        if (correlacion > 0.7) {\n          cat(\"- **Interpretación:** Sistema altamente progresivo\\n\")\n        } else if (correlacion > 0.3) {\n          cat(\"- **Interpretación:** Sistema moderadamente progresivo\\n\")\n        } else if (correlacion > -0.3) {\n          cat(\"- **Interpretación:** Sistema con progresividad variable\\n\")\n        } else {\n          cat(\"- **Interpretación:** Sistema con tendencia regresiva\\n\")\n        }\n        \n      } else {\n        cat(\"Datos insuficientes para generar análisis de progresividad por avalúo.\\n\")\n      }\n      \n    } else {\n      cat(\"No se encontraron datos de avalúo para este municipio en los registros detallados.\\n\")\n    }\n    \n  }, error = function(e) {\n    cat(\"*No fue posible generar el análisis de progresividad por avalúo para este municipio.*\\n\")\n    cat(\"*Motivo: Datos de transcripción no disponibles o incompletos.*\\n\")\n  })\n}\n```\n\n## Progresividad por área\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 10\n#| fig-height: 6\n\n# Verificar si existe la imagen ladder de área\nimg_area <- paste0(\"img_estatutos/\", params$cod_dane, \"_ladder_area.png\")\n\nif (file.exists(img_area)) {\n  cat(\"El análisis por área evalúa la progresividad basada en la superficie construida:\\n\\n\")\n  cat(\"![Progresividad por área](\", img_area, \"){width=90%}\\n\\n\")\n  cat(\"**Descripción:** Gráfico ladder que muestra la relación entre rangos de área construida (m²) y las tarifas prediales en \", params$nombre, \".\\n\\n\")\n  cat(\"**Interpretación:** Permite evaluar si el municipio penaliza o incentiva predios de mayor tamaño. Una progresividad negativa podría indicar incentivos a la densificación.\\n\\n\")\n} else {\n  # Generar gráfico dinámico desde los datos\n  cat(\"### Análisis de progresividad por área (generado dinámicamente)\\n\\n\")\n  \n  tryCatch({\n    bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n    \n    # Filtrar datos del municipio con información de área\n    datos_area <- bd_transcripciones %>%\n      filter(codigo_dane == params$cod_dane) %>%\n      filter(!is.na(area_desde) | !is.na(area_hasta)) %>%\n      filter(!is.na(tarifa))\n    \n    if (nrow(datos_area) > 0) {\n      library(ggplot2)\n      \n      # Preparar datos para gráfico\n      datos_plot_area <- datos_area %>%\n        mutate(\n          area_media = case_when(\n            !is.na(area_desde) & !is.na(area_hasta) ~ (area_desde + area_hasta) / 2,\n            !is.na(area_desde) ~ area_desde,\n            !is.na(area_hasta) ~ area_hasta,\n            TRUE ~ NA_real_\n          ),\n          area_desde = ifelse(is.na(area_desde), 0, area_desde),\n          area_hasta = ifelse(is.na(area_hasta), area_media * 2, area_hasta)\n        ) %>%\n        filter(!is.na(area_media), !is.na(tarifa), area_media > 0) %>%\n        arrange(area_media)\n      \n      if (nrow(datos_plot_area) >= 2) {\n        # Crear gráfico ladder para área con mejoras visuales\n        p_area <- ggplot(datos_plot_area, aes(x = area_media, y = tarifa)) +\n          geom_step(direction = \"hv\", color = \"darkgreen\", size = 1.2, alpha = 0.8) +\n          geom_point(color = \"darkgreen\", size = 2.5, alpha = 0.9) +\n          geom_smooth(method = \"loess\", se = TRUE, color = \"orange\", alpha = 0.3, size = 0.8) +\n          scale_x_continuous(\n            trans = \"log10\",\n            labels = scales::comma_format(suffix = \" m²\"),\n            name = \"Área construida (m², escala logarítmica)\",\n            breaks = scales::trans_breaks(\"log10\", function(x) 10^x),\n            minor_breaks = scales::trans_breaks(\"log10\", function(x) 10^x, n = 10)\n          ) +\n          scale_y_continuous(\n            labels = scales::number_format(suffix = \"‰\"),\n            name = \"Tarifa predial (por mil)\"\n          ) +\n          labs(\n            title = paste(\"Progresividad por área construida -\", params$nombre),\n            subtitle = \"Línea verde: escalones tarifarios | Línea naranja: tendencia suavizada\",\n            caption = \"Fuente: Análisis de estatutos tributarios • Mayor área → ¿Mayor o menor tarifa?\"\n          ) +\n          theme_minimal() +\n          theme(\n            plot.title = element_text(size = 14, face = \"bold\", color = \"darkgreen\"),\n            plot.subtitle = element_text(size = 11, color = \"gray40\"),\n            plot.caption = element_text(size = 9, color = \"gray50\"),\n            axis.title = element_text(size = 11),\n            panel.grid.minor = element_blank(),\n            panel.grid.major = element_line(color = \"gray90\", size = 0.5)\n          )\n        \n        print(p_area)\n        \n        # Análisis de progresividad por área mejorado\n        correlacion_area <- cor(datos_plot_area$area_media, datos_plot_area$tarifa, method = \"spearman\")\n        n_intervalos_area <- nrow(datos_plot_area)\n        tarifa_ordenada <- datos_plot_area$tarifa[order(datos_plot_area$area_media)]\n        incrementos_positivos_area <- sum(diff(tarifa_ordenada) > 0)\n        decrementos_area <- sum(diff(tarifa_ordenada) < 0)\n        prop_progresiva_area <- round(incrementos_positivos_area / (n_intervalos_area - 1) * 100, 1)\n        \n        # Calcular elasticidad área-tarifa\n        if (length(datos_plot_area$area_media) > 2) {\n          modelo_area <- lm(log(tarifa) ~ log(area_media), data = datos_plot_area)\n          elasticidad_area <- round(coef(modelo_area)[2], 3)\n        } else {\n          elasticidad_area <- NA\n        }\n        \n        cat(\"\\n**Análisis estadístico avanzado:**\\n\")\n        cat(\"- **Número de intervalos analizados:** \", n_intervalos_area, \"\\n\")\n        cat(\"- **Correlación área-tarifa (Spearman):** \", round(correlacion_area, 3), \"\\n\")\n        cat(\"- **Proporción de incrementos progresivos:** \", prop_progresiva_area, \"%\\n\")\n        cat(\"- **Incrementos vs. decrementos:** \", incrementos_positivos_area, \" vs \", decrementos_area, \"\\n\")\n        if (!is.na(elasticidad_area)) {\n          cat(\"- **Elasticidad área-tarifa:** \", elasticidad_area, \"\\n\")\n        }\n        \n        if (correlacion_area > 0.3) {\n          cat(\"- **Interpretación:** Las tarifas tienden a aumentar con el área (penalización a predios grandes)\\n\")\n        } else if (correlacion_area < -0.3) {\n          cat(\"- **Interpretación:** Las tarifas tienden a disminuir con el área (incentivo a predios grandes)\\n\")\n        } else {\n          cat(\"- **Interpretación:** Las tarifas no presentan una relación clara con el área\\n\")\n        }\n        \n        # Comparación con avalúo (si disponible)\n        datos_avaluo_comp <- bd_transcripciones %>%\n          filter(codigo_dane == params$cod_dane) %>%\n          filter(!is.na(avaluo_desde) | !is.na(avaluo_hasta)) %>%\n          filter(!is.na(tarifa))\n        \n        if (nrow(datos_avaluo_comp) > 1) {\n          datos_avaluo_comp <- datos_avaluo_comp %>%\n            mutate(\n              avaluo_medio = case_when(\n                !is.na(avaluo_desde) & !is.na(avaluo_hasta) ~ (avaluo_desde + avaluo_hasta) / 2,\n                !is.na(avaluo_desde) ~ avaluo_desde,\n                !is.na(avaluo_hasta) ~ avaluo_hasta,\n                TRUE ~ NA_real_\n              )\n            ) %>%\n            filter(!is.na(avaluo_medio))\n          \n          if (nrow(datos_avaluo_comp) > 1) {\n            correlacion_avaluo_comp <- cor(datos_avaluo_comp$avaluo_medio, datos_avaluo_comp$tarifa, method = \"spearman\")\n            cat(\"- **Comparación:** Correlación avalúo-tarifa: \", round(correlacion_avaluo_comp, 3), \n                \" vs área-tarifa: \", round(correlacion_area, 3), \"\\n\")\n            \n            if (abs(correlacion_area) > abs(correlacion_avaluo_comp)) {\n              cat(\"- **Observación:** El área parece ser un criterio más determinante que el avalúo\\n\")\n            } else {\n              cat(\"- **Observación:** El avalúo parece ser un criterio más determinante que el área\\n\")\n            }\n          }\n        }\n        \n      } else {\n        cat(\"Datos insuficientes para generar análisis de progresividad por área.\\n\")\n      }\n      \n    } else {\n      cat(\"No se encontraron datos de área para este municipio en los registros detallados.\\n\")\n    }\n    \n  }, error = function(e) {\n    cat(\"*No fue posible generar el análisis de progresividad por área para este municipio.*\\n\")\n    cat(\"*Motivo: Datos de transcripción no disponibles o incompletos.*\\n\")\n  })\n}\n```\n\n# Contexto departamental\n\n```{r}\n#| echo: false\n#| results: asis\n\ncat(\"## Posición relativa en Antioquia\\n\\n\")\n\n# Generar estadísticas comparativas\nif (nrow(datos_municipio) > 0) {\n  # Ranking por número de reglas\n  ranking_reglas <- bd_estatutos %>%\n    count(codigo_dane, mpio, sort = TRUE) %>%\n    mutate(ranking = row_number()) %>%\n    filter(codigo_dane == params$cod_dane)\n  \n  if (nrow(ranking_reglas) > 0) {\n    total_municipios <- bd_estatutos %>% distinct(codigo_dane) %>% nrow()\n    cat(\"- **Ranking por complejidad normativa:** \", ranking_reglas$ranking, \" de \", total_municipios, \" municipios\\n\")\n    cat(\"- **Número de reglas:** \", ranking_reglas$n, \"\\n\")\n    \n    # Clasificación\n    if (ranking_reglas$ranking <= total_municipios * 0.25) {\n      cat(\"- **Clasificación:** Alta complejidad normativa (cuartil superior)\\n\")\n    } else if (ranking_reglas$ranking <= total_municipios * 0.5) {\n      cat(\"- **Clasificación:** Complejidad normativa medio-alta\\n\")\n    } else if (ranking_reglas$ranking <= total_municipios * 0.75) {\n      cat(\"- **Clasificación:** Complejidad normativa medio-baja\\n\")\n    } else {\n      cat(\"- **Clasificación:** Baja complejidad normativa (cuartil inferior)\\n\")\n    }\n  }\n}\n\ncat(\"\\n\")\n\n# Enlaces a visualizaciones generales si existen\nimg_generales <- c(\n  \"tipologia_agregada.png\" = \"Tipologías agregadas del departamento\",\n  \"tipologia_todos.png\" = \"Complejidad normativa por municipio\",\n  \"map_rules_count.png\" = \"Mapa de complejidad normativa\",\n  \"tarifas_mapa_urbano.png\" = \"Mapa de tarifas urbanas\",\n  \"tarifas_mapa_rural.png\" = \"Mapa de tarifas rurales\"\n)\n\ncat(\"## Visualizaciones del contexto departamental\\n\\n\")\nfor (i in seq_along(img_generales)) {\n  img_path <- paste0(\"img_estatutos/\", names(img_generales)[i])\n  if (file.exists(img_path)) {\n    cat(\"- [\", img_generales[i], \"](\", img_path, \")\\n\")\n  }\n}\n```\n\n# Documentos de referencia\n\n```{r}\n#| echo: false\n#| results: asis\n\ncat(\"## Estatutos y documentos fuente\\n\\n\")\n\nif (nrow(freq_cat) > 0 && \"enlace_pdf\" %in% names(freq_cat)) {\n  enlaces_disponibles <- freq_cat %>% \n    filter(enlace_pdf != \"No disponible\") %>%\n    nrow()\n  \n  if (enlaces_disponibles > 0) {\n    cat(\"Se han identificado \", enlaces_disponibles, \" documentos fuente para este municipio. \")\n    cat(\"Los enlaces de descarga están disponibles en la tabla de estatutos al inicio de este documento.\\n\\n\")\n  } else {\n    cat(\"Los documentos fuente están en proceso de digitalización.\\n\\n\")\n  }\n} else {\n  cat(\"Los documentos fuente están en proceso de digitalización.\\n\\n\")\n}\n\ncat(\"## Metodología del análisis\\n\\n\")\ncat(\"Este análisis forma parte del proyecto de sistematización de estatutos tributarios de Antioquia, que incluye:\\n\\n\")\ncat(\"1. **Transcripción normativa:** Conversión de estatutos físicos a formato digital estructurado\\n\")\ncat(\"2. **Categorización:** Identificación de criterios tarifarios (avalúo, área, destino, estrato)\\n\")\ncat(\"3. **Análisis de progresividad:** Evaluación de la coherencia y equidad del sistema tarifario\\n\")\ncat(\"4. **Comparación intermunicipal:** Benchmarking con otros municipios del departamento\\n\\n\")\ncat(\"Para más información sobre la metodología completa, consulte el [análisis departamental](estatuto_index.html).\\n\")\n```\n\n# Resumen visual integrado\n\n```{r}\n#| echo: false\n#| results: asis\n#| fig-width: 12\n#| fig-height: 8\n\n# Solo generar si hay datos de transcripciones\ntryCatch({\n  bd_transcripciones <- lee_rds(\"ds_estatutos/BD_Transcripciones.rds\")\n  datos_resumen <- bd_transcripciones %>%\n    filter(codigo_dane == params$cod_dane)\n  \n  if (nrow(datos_resumen) > 0) {\n    cat(\"## Dashboard de análisis tributario\\n\\n\")\n    cat(\"Este resumen integra los principales hallazgos del análisis tributario de \", params$nombre, \":\\n\\n\")\n    \n    # Crear un layout de múltiples gráficos si hay suficientes datos\n    tryCatch({\n      library(gridExtra)\n      library(grid)\n      use_grid <- TRUE\n    }, error = function(e) {\n      use_grid <- FALSE\n    })\n    \n    plots_list <- list()\n    \n    # 1. Gráfico de tarifas mejorado con box plot y violin plot\n    datos_tarifas_res <- datos_resumen %>% filter(!is.na(tarifa), tarifa > 0)\n    if (nrow(datos_tarifas_res) > 1) {\n      p1 <- ggplot(datos_tarifas_res, aes(x = \"\", y = tarifa)) +\n        geom_violin(fill = \"lightblue\", alpha = 0.5, color = \"blue\") +\n        geom_boxplot(fill = \"lightblue\", alpha = 0.8, width = 0.3, \n                     outlier.color = \"red\", outlier.size = 2) +\n        geom_jitter(width = 0.1, alpha = 0.6, color = \"darkblue\", size = 1.5) +\n        stat_summary(fun = mean, geom = \"point\", shape = 18, size = 4, color = \"orange\") +\n        labs(\n          title = \"Distribución de tarifas\", \n          subtitle = paste(\"🔵 Datos | 📦 Cuartiles | 🟠 Promedio | 🔴 Outliers\"),\n          y = \"Tarifa (‰)\", \n          x = \"\"\n        ) +\n        theme_minimal() +\n        theme(\n          plot.title = element_text(size = 12, face = \"bold\"),\n          plot.subtitle = element_text(size = 9, color = \"gray50\"),\n          axis.text.x = element_blank(),\n          axis.ticks.x = element_blank()\n        )\n      plots_list <- append(plots_list, list(p1))\n    }\n    \n    # 2. Gráfico de progresividad por avalúo si hay datos\n    datos_avaluo_res <- datos_resumen %>%\n      filter(!is.na(avaluo_desde) | !is.na(avaluo_hasta)) %>%\n      filter(!is.na(tarifa)) %>%\n      mutate(\n        avaluo_medio = case_when(\n          !is.na(avaluo_desde) & !is.na(avaluo_hasta) ~ (avaluo_desde + avaluo_hasta) / 2,\n          !is.na(avaluo_desde) ~ avaluo_desde,\n          !is.na(avaluo_hasta) ~ avaluo_hasta,\n          TRUE ~ NA_real_\n        )\n      ) %>%\n      filter(!is.na(avaluo_medio)) %>%\n      arrange(avaluo_medio)\n    \n    if (nrow(datos_avaluo_res) >= 3) {\n      # Calcular R² para mostrar calidad del ajuste\n      modelo_temp <- lm(tarifa ~ log10(avaluo_medio), data = datos_avaluo_res)\n      r_squared <- round(summary(modelo_temp)$r.squared, 3)\n      \n      p2 <- ggplot(datos_avaluo_res, aes(x = avaluo_medio, y = tarifa)) +\n        geom_point(aes(size = avaluo_medio), color = \"darkblue\", alpha = 0.7) +\n        geom_smooth(method = \"lm\", se = TRUE, color = \"red\", linetype = \"dashed\", alpha = 0.3) +\n        geom_smooth(method = \"loess\", se = FALSE, color = \"green\", size = 1, alpha = 0.8) +\n        scale_x_continuous(\n          trans = \"log10\", \n          labels = scales::comma_format(scale = 1e-6, suffix = \"M\"),\n          breaks = scales::trans_breaks(\"log10\", function(x) 10^x, n = 4)\n        ) +\n        scale_size_continuous(guide = \"none\", range = c(1, 4)) +\n        labs(\n          title = \"Progresividad por avalúo\", \n          subtitle = paste(\"🔴 Tendencia lineal (R²=\", r_squared, \") | 🟢 Tendencia suavizada\"),\n          x = \"Avalúo (UVT)\", \n          y = \"Tarifa (‰)\"\n        ) +\n        theme_minimal() +\n        theme(\n          plot.title = element_text(size = 12, face = \"bold\"),\n          plot.subtitle = element_text(size = 9, color = \"gray50\")\n        )\n      plots_list <- append(plots_list, list(p2))\n    }\n    \n    # 3. Gráfico de criterios utilizados\n    criterios_summary <- datos_resumen %>%\n      summarise(\n        Avalúo = sum(!is.na(avaluo_desde) | !is.na(avaluo_hasta)),\n        Área = sum(!is.na(area_desde) | !is.na(area_hasta)),\n        Destino = sum(!is.na(destino) & destino != \"\", na.rm = TRUE),\n        Estrato = sum(!is.na(estrato) & estrato != \"\", na.rm = TRUE),\n        Zona = sum(!is.na(zona) & zona != \"\", na.rm = TRUE)\n      ) %>%\n      tidyr::pivot_longer(everything(), names_to = \"Criterio\", values_to = \"Frecuencia\") %>%\n      filter(Frecuencia > 0)\n    \n    if (nrow(criterios_summary) > 0) {\n      p3 <- ggplot(criterios_summary, aes(x = reorder(Criterio, Frecuencia), y = Frecuencia)) +\n        geom_col(fill = \"darkgreen\", alpha = 0.7) +\n        coord_flip() +\n        labs(title = \"Criterios utilizados\", x = \"Criterio\", y = \"Número de reglas\") +\n        theme_minimal() +\n        theme(plot.title = element_text(size = 12, face = \"bold\"))\n      plots_list <- append(plots_list, list(p3))\n    }\n    \n    # Mostrar gráficos\n    if (length(plots_list) > 0) {\n      if (use_grid && length(plots_list) > 1) {\n        # Usar grid si está disponible\n        if (length(plots_list) == 2) {\n          grid.arrange(grobs = plots_list, ncol = 2)\n        } else if (length(plots_list) >= 3) {\n          grid.arrange(grobs = plots_list, ncol = 2, nrow = 2)\n        }\n      } else {\n        # Mostrar gráficos individualmente\n        for (i in seq_along(plots_list)) {\n          print(plots_list[[i]])\n        }\n      }\n      \n      cat(\"\\n**🎯 Interpretación integral del dashboard:**\\n\")\n      cat(\"Este dashboard proporciona una **visión 360° del sistema tributario** de \", params$nombre, \", integrando múltiples dimensiones analíticas:\\n\\n\")\n      \n      # Análisis integrado más sofisticado\n      cat(\"**📊 Resumen ejecutivo:**\\n\")\n      total_reglas <- nrow(datos_resumen)\n      complejidad_score <- 0\n      \n      # Calcular score de complejidad\n      if (nrow(criterios_summary) > 0) {\n        complejidad_score <- complejidad_score + (nrow(criterios_summary) * 20)\n      }\n      if (nrow(datos_tarifas_res) > 0) {\n        n_tarifas_unicas <- length(unique(datos_tarifas_res$tarifa))\n        complejidad_score <- complejidad_score + min(n_tarifas_unicas * 5, 50)\n        cv_tarifas <- sd(datos_tarifas_res$tarifa) / mean(datos_tarifas_res$tarifa)\n        if (cv_tarifas > 0.5) complejidad_score <- complejidad_score + 30\n      }\n      \n      cat(\"- **📈 Complejidad normativa:** \")\n      if (complejidad_score >= 80) {\n        cat(\"ALTA (score: \", complejidad_score, \") - Sistema muy sofisticado\\n\")\n      } else if (complejidad_score >= 50) {\n        cat(\"MODERADA (score: \", complejidad_score, \") - Sistema equilibrado\\n\")\n      } else {\n        cat(\"BAJA (score: \", complejidad_score, \") - Sistema simplificado\\n\")\n      }\n      \n      cat(\"- **🔢 Total de reglas analizadas:** \", total_reglas, \"\\n\")\n      \n      if (nrow(datos_tarifas_res) > 0) {\n        tarifa_promedio <- round(mean(datos_tarifas_res$tarifa), 2)\n        tarifa_mediana <- round(median(datos_tarifas_res$tarifa), 2)\n        dispersion <- round(sd(datos_tarifas_res$tarifa) / mean(datos_tarifas_res$tarifa), 3)\n        \n        cat(\"- **💰 Estructura tarifaria:**\\n\")\n        cat(\"  - Tarifas únicas: \", length(unique(datos_tarifas_res$tarifa)), \"\\n\")\n        cat(\"  - Tarifa típica: \", tarifa_mediana, \"‰ (mediana)\\n\")\n        cat(\"  - Rango: \", min(datos_tarifas_res$tarifa), \"‰ - \", max(datos_tarifas_res$tarifa), \"‰\\n\")\n        cat(\"  - Uniformidad: \", if(dispersion < 0.3) \"Alta\" else if(dispersion < 0.7) \"Moderada\" else \"Baja\", \" (CV: \", dispersion, \")\\n\")\n      }\n      \n      if (nrow(criterios_summary) > 0) {\n        criterio_principal <- criterios_summary$Criterio[which.max(criterios_summary$Frecuencia)]\n        cat(\"- **🎯 Criterios tarifarios activos:** \", nrow(criterios_summary), \"\\n\")\n        cat(\"  - Criterio principal: \", criterio_principal, \" (\", max(criterios_summary$Frecuencia), \" reglas)\\n\")\n      }\n      \n      # Análisis de progresividad si hay datos de avalúo\n      if (nrow(datos_avaluo_res) >= 3) {\n        cor_avaluo <- cor(datos_avaluo_res$avaluo_medio, datos_avaluo_res$tarifa, method = \"spearman\")\n        cat(\"- **📈 Progresividad por avalúo:** \")\n        if (cor_avaluo > 0.7) {\n          cat(\"ALTA (r=\", round(cor_avaluo, 2), \") - Sistema muy progresivo\\n\")\n        } else if (cor_avaluo > 0.3) {\n          cat(\"MODERADA (r=\", round(cor_avaluo, 2), \") - Progresividad parcial\\n\")\n        } else if (cor_avaluo > -0.3) {\n          cat(\"VARIABLE (r=\", round(cor_avaluo, 2), \") - Sin patrón claro\\n\")\n        } else {\n          cat(\"REGRESIVA (r=\", round(cor_avaluo, 2), \") - Tarifa decrece con avalúo\\n\")\n        }\n      }\n      \n      cat(\"\\n**🔍 Recomendaciones basadas en el análisis:**\\n\")\n      if (complejidad_score >= 80) {\n        cat(\"- Considerar **simplificación** del esquema tarifario\\n\")\n        cat(\"- Implementar **herramientas digitales** para facilitar aplicación\\n\")\n      } else if (complejidad_score < 30) {\n        cat(\"- Evaluar si el esquema actual **captura adecuadamente** la capacidad contributiva\\n\")\n        cat(\"- Considerar mayor **diferenciación** tarifaria si es viable\\n\")\n      } else {\n        cat(\"- Mantener **equilibrio actual** entre simplicidad y equidad\\n\")\n        cat(\"- Realizar **revisiones periódicas** del esquema\\n\")\n      }\n      \n      if (nrow(datos_tarifas_res) > 0 && sd(datos_tarifas_res$tarifa) / mean(datos_tarifas_res$tarifa) > 1) {\n        cat(\"- **Alta dispersión** detectada: revisar coherencia entre tarifas\\n\")\n      }\n    }\n    \n  } else {\n    cat(\"No hay suficientes datos para generar el dashboard visual.\\n\")\n  }\n  \n}, error = function(e) {\n  cat(\"*Dashboard visual no disponible para este municipio.*\\n\")\n})\n```\n\n# Estadísticas avanzadas del municipio\n\n```{r}\n#| echo: false\n#| results: asis\n\nif (nrow(datos_municipio) > 0) {\n  cat(\"## Análisis temporal de la normativa\\n\\n\")\n  \n  # Análisis temporal si hay datos de año\n  if (\"anio\" %in% names(datos_municipio) && any(!is.na(datos_municipio$anio))) {\n    # Evolución temporal\n    evolucion <- datos_municipio %>%\n      filter(!is.na(anio)) %>%\n      count(anio, sort = TRUE)\n    \n    if (nrow(evolucion) > 1) {\n      cat(\"### Evolución de la actividad normativa\\n\\n\")\n      anos_activos <- evolucion$anio\n      cat(\"- **Años con mayor actividad normativa:** \", paste(head(anos_activos, 3), collapse = \", \"), \"\\n\")\n      cat(\"- **Período de mayor estabilidad:** \")\n      \n      # Buscar períodos sin cambios\n      gaps <- diff(anos_activos)\n      if (any(gaps > 1)) {\n        cat(\"Se observan períodos de estabilidad normativa entre algunos años\\n\")\n      } else {\n        cat(\"Actividad normativa continua en el período analizado\\n\")\n      }\n      \n      # Tabla de evolución\n      cat(\"\\n\")\n      kable(evolucion, \n            col.names = c(\"Año\", \"Número de registros\"),\n            caption = \"Evolución temporal de la normativa tributaria\")\n      cat(\"\\n\")\n    }\n  }\n  \n  # Análisis de tipos de normativa\n  if (\"tipo\" %in% names(datos_municipio) && any(!is.na(datos_municipio$tipo))) {\n    cat(\"## Tipología normativa\\n\\n\")\n    \n    tipos_freq <- datos_municipio %>%\n      filter(!is.na(tipo)) %>%\n      count(tipo, sort = TRUE)\n    \n    if (nrow(tipos_freq) > 0) {\n      cat(\"### Distribución por tipo de normativa\\n\\n\")\n      kable(tipos_freq, \n            col.names = c(\"Tipo de normativa\", \"Frecuencia\"),\n            caption = \"Tipos de instrumentos normativos utilizados\")\n      cat(\"\\n\")\n      \n      tipo_principal <- tipos_freq$tipo[1]\n      freq_principal <- tipos_freq$n[1]\n      porcentaje_principal <- round((freq_principal / nrow(datos_municipio)) * 100, 1)\n      \n      cat(\"- **Instrumento normativo predominante:** \", tipo_principal, \n          \" (\", freq_principal, \" registros, \", porcentaje_principal, \"%)\\n\")\n    }\n  }\n  \n  # Comparación con promedios departamentales\n  cat(\"## Comparación departamental\\n\\n\")\n  \n  # Estadísticas departamentales\n  stats_dpto <- bd_estatutos %>%\n    group_by(codigo_dane) %>%\n    summarise(\n      total_registros = n(),\n      .groups = 'drop'\n    )\n  \n  promedio_dpto <- mean(stats_dpto$total_registros, na.rm = TRUE)\n  mediana_dpto <- median(stats_dpto$total_registros, na.rm = TRUE)\n  \n  registros_municipio <- nrow(datos_municipio)\n  \n  cat(\"- **Registros de este municipio:** \", registros_municipio, \"\\n\")\n  cat(\"- **Promedio departamental:** \", round(promedio_dpto, 1), \"\\n\")\n  cat(\"- **Mediana departamental:** \", round(mediana_dpto, 1), \"\\n\")\n  \n  # Clasificación relativa\n  if (registros_municipio > promedio_dpto) {\n    cat(\"- **Clasificación:** Por encima del promedio departamental (\", \n        round((registros_municipio - promedio_dpto) / promedio_dpto * 100, 1), \n        \"% más registros)\\n\")\n  } else {\n    cat(\"- **Clasificación:** Por debajo del promedio departamental (\", \n        round((promedio_dpto - registros_municipio) / promedio_dpto * 100, 1), \n        \"% menos registros)\\n\")\n  }\n  \n  # Percentil\n  percentil <- round(sum(stats_dpto$total_registros <= registros_municipio) / nrow(stats_dpto) * 100, 1)\n  cat(\"- **Percentil departamental:** \", percentil, \"% (\", \n      round(100 - percentil, 1), \"% de municipios tienen más registros)\\n\")\n\n} else {\n  cat(\"No hay datos suficientes para generar estadísticas avanzadas.\\n\")\n}\n```\n\n# Recomendaciones específicas\n\n```{r}\n#| echo: false\n#| results: asis\n\nif (nrow(datos_municipio) > 0) {\n  cat(\"## Recomendaciones de política tributaria\\n\\n\")\n  \n  # Generar recomendaciones basadas en las características del municipio\n  registros_municipio <- nrow(datos_municipio)\n  \n  # Obtener estadísticas para comparación\n  stats_dpto <- bd_estatutos %>%\n    group_by(codigo_dane) %>%\n    summarise(total_registros = n(), .groups = 'drop')\n  \n  promedio_dpto <- mean(stats_dpto$total_registros, na.rm = TRUE)\n  cuartil_superior <- quantile(stats_dpto$total_registros, 0.75, na.rm = TRUE)\n  cuartil_inferior <- quantile(stats_dpto$total_registros, 0.25, na.rm = TRUE)\n  \n  cat(\"Basándose en el análisis comparativo, se sugieren las siguientes recomendaciones:\\n\\n\")\n  \n  if (registros_municipio > cuartil_superior) {\n    cat(\"### Simplificación normativa (Alta complejidad)\\n\\n\")\n    cat(\"- **Revisión integral:** Considerar la consolidación de reglas similares para reducir complejidad administrativa\\n\")\n    cat(\"- **Digitalización:** Implementar herramientas digitales para facilitar el cálculo y aplicación de tarifas\\n\")\n    cat(\"- **Capacitación:** Fortalecer las competencias técnicas del personal tributario\\n\")\n    cat(\"- **Comunicación:** Desarrollar material didáctico para facilitar el entendimiento ciudadano\\n\\n\")\n  } else if (registros_municipio < cuartil_inferior) {\n    cat(\"### Optimización del potencial tributario (Baja complejidad)\\n\\n\")\n    cat(\"- **Análisis de brechas:** Evaluar si la simplicidad actual captura adecuadamente la capacidad contributiva\\n\")\n    cat(\"- **Benchmarking:** Considerar mejores prácticas de municipios similares\\n\")\n    cat(\"- **Progresividad:** Evaluar la implementación de esquemas más progresivos si es técnicamente viable\\n\")\n    cat(\"- **Actualización:** Revisar la vigencia y pertinencia de las tarifas actuales\\n\\n\")\n  } else {\n    cat(\"### Optimización del esquema actual (Complejidad media)\\n\\n\")\n    cat(\"- **Eficiencia:** Evaluar la efectividad del esquema actual en términos de recaudo y equidad\\n\")\n    cat(\"- **Actualización periódica:** Establecer cronogramas regulares de revisión normativa\\n\")\n    cat(\"- **Monitoreo:** Implementar indicadores de seguimiento a la aplicación de tarifas\\n\")\n    cat(\"- **Participación:** Involucrar a la ciudadanía en procesos de actualización normativa\\n\\n\")\n  }\n  \n  cat(\"### Recomendaciones generales\\n\\n\")\n  cat(\"- **Transparencia:** Publicar de manera clara y accesible todas las tarifas vigentes\\n\")\n  cat(\"- **Tecnología:** Aprovechar herramientas digitales para mejorar la gestión tributaria\\n\")\n  cat(\"- **Equidad:** Evaluar periódicamente el impacto distributivo del sistema tarifario\\n\")\n  cat(\"- **Coordinación:** Mantener coherencia con las políticas tributarias departamentales\\n\\n\")\n  \n} else {\n  cat(\"Para generar recomendaciones específicas se requieren datos adicionales del municipio.\\n\")\n}\n```"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":3,"number-sections":true,"output-file":"analisis_estatutos.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de última modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar sobre problema","back-to-top":"Volver arriba","search-no-results-text":"No se han encontrado resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Demostración","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Más antiguo","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre del archivo","listing-page-field-filemodified":"Última modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.8.24","theme":["cosmo"],"toc-location":"right","title":"Análisis estatuto de Urrao","params":{"cod_dane":"05847","nombre":"Urrao"},"smooth-scroll":true},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html","revealjs"]}